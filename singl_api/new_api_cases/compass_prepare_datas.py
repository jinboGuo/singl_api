# coding:utf-8
import json
import os
import time
from new_api_cases.compass_deal_parameters import deal_random
from basic_info.setting import hdfs_url, ms, log, datasource_url, resource_type
from util.encrypt import parameter_ungzip
from util.get_deal_parameter import get_tenant_id, get_resourceid
from util.timestamp_13 import data_now

def update_job(data):
    try:
        sql = "select job_oid,job_name,job_pool_oid,re_oid,handle_oid,flow_name,flow_id,again_re_oid,cluster_name from s_c_job where job_name like '%s%%%%' order by create_time desc limit 1" % data
        job_info = ms.ExecuQuery(sql.encode('utf-8'))
        job_oid, job_name, job_pool_oid, re_oid, handle_oid, flow_name, flow_id, again_re_oid, cluster_name = str(job_info[0]["job_oid"]), job_info[0]["job_name"], job_info[0]["job_pool_oid"], job_info[0]["re_oid"], job_info[0]["handle_oid"], job_info[0]["flow_name"], job_info[0]["flow_id"], job_info[0]["again_re_oid"], job_info[0]["cluster_name"]
        new_data = {"id": job_oid, "jobName": job_name, "jobType": 2, "sliceType": "H", "status": 1, "msgOid": "", "jsonOid": "", "strategyOid": "2", "delayTime": "60", "configStr": "1", "taskType": 1, "taskLevel": 5, "jobPoolOid": job_pool_oid, "timeoutTime": "", "eqTimeRun": "", "reOid": re_oid, "cdoFilterClass": "", "isTrigger": "N", "handleOid": handle_oid, "filterConf": "1", "flowName": flow_name, "flowId": flow_id, "flowVer": "0", "againType": "1", "againReOid": again_re_oid, "maxRun": 1, "flowConf": "", "clusterName": cluster_name, "runTime": "", "timeOrder": "1", "userExe": "", "otherPars": "", "jobDesc": "1", "createTime": data_now(), "planId": "", "delayType": 1, "clusterExeName": ""}
        return new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def add_job(data):
    data = data.split('&')
    try:
        re_sql = "select re_oid from s_c_re where re_name like '%s%%%%' limit 1" % data[0]
        re_info = ms.ExecuQuery(re_sql.encode('utf-8'))
        re_oid = str(re_info[0]["re_oid"])
        flow_sql = "select dataflow_name,dataflow_oid ,cluster_name from s_c_dataflow where dataflow_name like '%s%%%%' order by create_time desc limit 1" % data[1]
        flow_info = ms.ExecuQuery(flow_sql.encode('utf-8'))
        df_name, df_id, cluster_name = flow_info[0]["dataflow_name"], str(flow_info[0]["dataflow_oid"]),flow_info[0]["cluster_name"]
        pool_sql = "select job_pool_oid from s_c_job_pool where pool_name like '%s%%%%' limit 1" % data[2]
        pool_info = ms.ExecuQuery(pool_sql.encode('utf-8'))
        job_pool_oid = str(pool_info[0]["job_pool_oid"])
        handle_sql = "select handle_oid from s_c_job_handle where handle_class like '%s%%%%' limit 1" % data[3]
        handle_info = ms.ExecuQuery(handle_sql.encode('utf-8'))
        handle_oid = str(handle_info[0]["handle_oid"])
        if 'test_no_supp' in data:
            new_data = {"againReOid": re_oid, "againType": "1", "clusterExeName": "", "clusterName": cluster_name, "configStr": "1", "delayTime": "60", "delayType": 1, "filterConf": "1", "flowConf": "", "flowName": df_name, "flowVer": "0", "handleOid": handle_oid, "isTrigger": "N", "jobDesc": "1", "jobName": "autotest_随机数", "jobPoolOid":  job_pool_oid, "jobType": 2, "jsonOid": "", "maxRun": 1, "msgOid": "", "otherPars": "", "planId": "", "reOid": re_oid, "runTime": "", "sliceType": "H", "status": 1, "strategyOid": "2", "taskLevel": 5, "taskType": 1, "timeOrder": "1", "userExe": "", "flowId": df_id}
            deal_random(new_data)
            return new_data
        elif 'test_add_supp' in data:
            new_data = {"againReOid": re_oid, "againType": "1", "clusterExeName": "", "clusterName": cluster_name, "configStr": "1", "delayTime": "60", "delayType": 1, "filterConf": "1", "flowConf": "", "flowName": df_name, "flowVer": "0", "handleOid": handle_oid, "isTrigger": "A", "jobDesc": "1", "jobName": "autotest_随机数", "jobPoolOid":  job_pool_oid, "jobType": 2, "jsonOid": "", "maxRun": 1, "msgOid": "", "otherPars": "", "planId": "", "reOid": re_oid, "runTime": "", "sliceType": "H", "status": 1, "strategyOid": "2", "taskLevel": 5, "taskType": 1, "timeOrder": "1", "userExe": "", "flowId": df_id}
            deal_random(new_data)
            return new_data
        elif 'test_total_supp' in data:
            new_data = {"againReOid": re_oid, "againType": "1", "clusterExeName": "", "clusterName": cluster_name, "configStr": "1", "delayTime": "60", "delayType": 1, "filterConf": "1", "flowConf": "", "flowName": df_name, "flowVer": "0", "handleOid": handle_oid, "isTrigger": "Y", "jobDesc": "1", "jobName": "autotest_随机数", "jobPoolOid":  job_pool_oid, "jobType": 2, "jsonOid": "", "maxRun": 1, "msgOid": "", "otherPars": "", "planId": "", "reOid": re_oid, "runTime": "", "sliceType": "H", "status": 1, "strategyOid": "2", "taskLevel": 5, "taskType": 1, "timeOrder": "1", "userExe": "", "flowId": df_id}
            deal_random(new_data)
            return new_data
        elif 'test_cover_supp' in data:
            new_data = {"againReOid": re_oid, "againType": "1", "clusterExeName": "", "clusterName": cluster_name, "configStr": "1", "delayTime": "60", "delayType": 1, "filterConf": "1", "flowConf": "", "flowName": df_name, "flowVer": "0", "handleOid": handle_oid, "isTrigger": "R", "jobDesc": "1", "jobName": "autotest_随机数", "jobPoolOid":  job_pool_oid, "jobType": 2, "jsonOid": "", "maxRun": 1, "msgOid": "", "otherPars": "", "planId": "", "reOid": re_oid, "runTime": "", "sliceType": "H", "status": 1, "strategyOid": "2", "taskLevel": 5, "taskType": 1, "timeOrder": "1", "userExe": "", "flowId": df_id}
            deal_random(new_data)
            return new_data
        else:
            return
    except Exception as e:
        log.error("异常信息：%s" % e)

def add_jobSingle(data):
    try:
        sql = "select job_oid,job_name,slice_type from s_c_job where job_name = '%s' order by create_time desc limit 1" % data
        job_info = ms.ExecuQuery(sql.encode('utf-8'))
        job_oid, job_name, slice_type = str(job_info[0]["job_oid"]), job_info[0]["job_name"], job_info[0]["slice_type"]
        if 'gdemo' == data:
            new_data = {"jobOid":  job_oid, "sliceType":  slice_type, "sliceTime":  data_now(), "singleType":  0, "jobLevel":  "1", "taskName":  job_name}
            deal_random(new_data)
            return new_data
        elif 'gdemo_add_supp' == data:
            new_data = {"jobOid":  job_oid, "sliceType":  slice_type, "sliceTime":  data_now(), "singleType":  1, "jobLevel":  "1", "taskName":  job_name}
            deal_random(new_data)
            return new_data
        elif 'gdemo_total_supp' == data:
            new_data = {"jobOid":  job_oid, "sliceType":  slice_type, "sliceTime":  data_now(), "singleType":  2, "jobLevel":  "1", "taskName":  job_name}
            deal_random(new_data)
            return new_data
        elif 'test_cover' == data:
            new_data = {"jobOid":  job_oid, "sliceType":  slice_type, "sliceTime":  data_now(), "singleType":  3, "jobLevel":  "1", "taskName":  job_name}
            deal_random(new_data)
            return new_data
        else:
            return
    except Exception as e:
        log.error("异常信息：%s" % e)

def update_job_single(data):
    try:
        sql = "select single_oid,job_oid,slice_time,create_time,status,single_type,task_name from s_r_job_single where task_name like '%s%%%%' order by create_time desc limit 1" % data
        job_info = ms.ExecuQuery(sql.encode('utf-8'))
        single_oid, job_oid, slice_time, create_time, status, single_type = str(job_info[0]["single_oid"]), str(job_info[0]["job_oid"]), str(job_info[0]["slice_time"]), str(job_info[0]["create_time"]), job_info[0]["status"], job_info[0]["single_type"]
        new_data = {"id":  single_oid, "jobOid":  job_oid, "jobLevel":  1, "sliceTime":  slice_time, "createTime":  create_time, "status":  status , "singleType":  single_type, "taskName":  "gdemo随机数", "sliceType": "H"}
        deal_random(new_data)
        return new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def add_jobMap(data):
    try:
        sql = "select job_oid,cluster_name from s_c_job where job_name like '%s%%%%' order by create_time desc limit 1" % data
        job_info = ms.ExecuQuery(sql.encode('utf-8'))
        job_oid, cluster_name = str(job_info[0]["job_oid"]), job_info[0]["cluster_name"]
        if 'autotest' == data:
            new_data = {"jobDataOid": "", "jobOid":  job_oid, "clusterName":  cluster_name, "dataformatName":  "test_supp1211", "sliceTimeRegType": 1, "sliceTimeReg": "", "mustLevel": 3, "mustType": 1, "mustPars": "100", "mustLine": "", "mustOuttime": ""}
            return new_data
        else:
            return
    except Exception as e:
        log.error("异常信息：%s" % e)

def update_jobMap(data):

    try:
        sql = "select job_map_oid ,job_oid,dataformat_Name,cluster_name,job_name from s_c_job_map where job_name like '%s%%%%' limit 1" % data
        job_info = ms.ExecuQuery(sql.encode('utf-8'))
        job_map_oid, job_oid, dataformat_name,cluster_name, job_name = str(job_info[0]["job_map_oid"]), str(job_info[0]["job_oid"]), job_info[0]["dataformat_Name"], job_info[0]["cluster_name"], job_info[0]["job_name"]
        new_data = {"jobDataOid":  "", "jobOid":  job_oid, "clusterName":  cluster_name, "dataformatName":  dataformat_name, "sliceTimeRegType": 1, "sliceTimeReg": "", "mustLevel": 3, "mustType": 1, "mustPars": "100", "mustLine": "", "mustOuttime": "", "id":  job_map_oid, "jobName":  job_name, "jobType":  "2"}
        return new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def query_re_th(data):
    try:
        re_oid = []
        sql = "select re_oid from s_c_re where re_name like  '%s%%%%' limit 1" % data
        job_info = ms.ExecuQuery(sql.encode('utf-8'))
        re_oid.append(str(job_info[0]["re_oid"]))
        new_data = {"fieldGroup":{"type":"FieldGroup","group":True,"andOr":"AND","fields":[{"type":"Field","group":False,"andOr":"AND","name":"reOid","oper":"EQUAL","value":re_oid,"label":""}]},"ordSort":[{"name":"lastModifiedTime","order":"DESC"}],"pageable":{"pageNum":0,"pageSize":100,"pageable":True}}
        return new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def add_re_th(data):
    try:
        delete_scheduler()
        sql = "select re_oid from s_c_re where re_name like  '%s%%%%' limit 1" % data
        job_info = ms.ExecuQuery(sql.encode('utf-8'))
        re_oid = str(job_info[0]["re_oid"])
        new_data = {"reOid":  re_oid, "minValue":  "", "maxValue":  "10000", "exeMem":  "2G", "exeNum":  "2", "driverMem":  "2G"}
        return new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def update_re_th(data):
    try:
        sql = "select re_th_oid, re_oid from s_c_re_th where re_oid in(select t.re_oid from (select * from s_c_re where re_name like '%s%%%%' limit 1) as t)" % data
        job_info = ms.ExecuQuery(sql.encode('utf-8'))
        re_th_oid, re_oid = str(job_info[0]["re_th_oid"]), str(job_info[0]["re_oid"])
        new_data = {"id":  re_th_oid, "reOid":  re_oid, "minValue":  "", "maxValue":  "10000", "exeMem":  "2G", "exeNum":  "2", "driverMem":  "2G"}
        return re_th_oid, new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def query_re_th_ext(data):
    try:
        re_th_oid = []
        sql = "select re_th_oid from s_c_re_th where re_oid in(select t.re_oid from (select * from s_c_re where re_name like '%s%%%%' limit 1) as t)" % data
        job_info = ms.ExecuQuery(sql.encode('utf-8'))
        re_th_oid.append(str(job_info[0]["re_th_oid"]))
        new_data ={"fieldGroup":{"type":"FieldGroup","group":True,"andOr":"AND","fields":[{"type":"Field","group":False,"andOr":"AND","name":"reThOid","oper":"EQUAL","value":re_th_oid,"label":""}]},"ordSort":[{"name":"lastModifiedTime","order":"DESC"}],"pageable":{"pageNum":0,"pageSize":100,"pageable":True}}
        return new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def add_re_th_ext(data):
    try:
        sql = "select re_th_oid from s_c_re_th where re_oid in(select t.re_oid from (select * from s_c_re where re_name like '%s%%%%' limit 1) as t)" % data
        job_info = ms.ExecuQuery(sql.encode('utf-8'))
        re_th_oid = str(job_info[0]["re_th_oid"])
        new_data = {"reThOid":  re_th_oid, "extKey":  "spark.executor.cores", "extValue":  "2"}
        return new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def update_re_th_ext(data):
    try:
        sql = "select re_th_ext_oid ,re_th_oid from s_c_re_th_ext where re_th_oid in(select t.re_th_oid from s_c_re_th as t where re_oid in(select s.re_oid from (select * from s_c_re where re_name like '%s%%%%' limit 1) as s))" % data
        job_info = ms.ExecuQuery(sql.encode('utf-8'))
        re_th_ext_oid, re_th_oid = str(job_info[0]["re_th_ext_oid"]), str(job_info[0]["re_th_oid"])
        new_data = {"id":  re_th_ext_oid, "reThOid":  re_th_oid, "extKey":  "spark.executor.cores", "extValue":  "4"}
        return re_th_ext_oid, new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def update_asset_directory(data):
    try:
        asset_directory = "select parent_id,tenant_id,id,ord,path from merce_resource_dir mrd where res_type ='jobview_dir' and creator='admin' and name like'%s%%%%' order by create_time desc limit 1" % data
        asset_directory_info = ms.ExecuQuery(asset_directory.encode('utf-8'))
        new_data = {"name": "test_asset随机数", "parentId": asset_directory_info[0]["parent_id"], "resType": "jobview_dir", "tenantId": asset_directory_info[0]["tenant_id"], "owner": None, "enabled": None, "creator": None, "createTime": None, "lastModifier": None, "lastModifiedTime": None, "id": asset_directory_info[0]["id"], "version": None, "groupCount": None, "groupFieldValue": None, "order": asset_directory_info[0]["ord"], "isHide": None, "path": asset_directory_info[0]["path"], "children": [], "halfSelect": True, "hasChildren": False, "expiredPeriod": 0}
        deal_random(new_data)
        return new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def move_asset_directory(data):
    try:
        asset_directory = "select parent_id,id from merce_resource_dir mrd where res_type ='jobview_dir' and creator='admin' and name like'%s%%%%' order by create_time desc limit 1" % data
        asset_directory_info = ms.ExecuQuery(asset_directory.encode('utf-8'))
        new_data= [asset_directory_info[0]["id"]]
        return asset_directory_info[0]["parent_id"], new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def duplicate_asset_directory(data):
    try:
        asset_directory = "select parent_id,name from merce_resource_dir mrd where res_type ='jobview_dir' and creator='admin' and name like'%s%%%%' order by create_time desc limit 1" % data
        asset_directory_info = ms.ExecuQuery(asset_directory.encode('utf-8'))
        new_data = {"name":  asset_directory_info[0]["name"], "parentId":  asset_directory_info[0]["parent_id"], "resType":  "jobview_dir"}
        return new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def duplicate_move_asset_directory(data):
    try:
        asset_directory = "select name,parent_id,tenant_id,id,ord,path from merce_resource_dir mrd where res_type ='jobview_dir' and creator='admin' and name like'%s%%%%' order by create_time desc limit 1" % data
        asset_directory_info = ms.ExecuQuery(asset_directory.encode('utf-8'))
        new_data = {"name":  asset_directory_info[0]["name"], "parentId":  asset_directory_info[0]["parent_id"], "resType":  "jobview_dir", "tenantId":  asset_directory_info[0]["tenant_id"], "owner":  None, "enabled": None, "creator": None, "createTime": None, "lastModifier": None, "lastModifiedTime": None, "id": asset_directory_info[0]["id"], "version": None, "groupCount": None, "groupFieldValue": None, "order": asset_directory_info[0]["ord"], "isHide": None, "path": asset_directory_info[0]["path"], "children": [], "halfSelect": True, "hasChildren": False, "expiredPeriod": 0}
        return new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def delete_scheduler():
    try:
        merce_resource_dir = "delete from merce_resource_dir where name like 'gjb_mysql%'"
        ms.ExecuNoQuery(merce_resource_dir.encode('utf-8'))
        merce_flow_dataset_map = "delete from merce_flow_dataset_map where dataset_name like 'New%'"
        ms.ExecuNoQuery(merce_flow_dataset_map.encode('utf-8'))
        merce_flow_dataset_map1 = "delete from merce_flow_dataset_map where dataset_name like 'gjb%'"
        ms.ExecuNoQuery(merce_flow_dataset_map1.encode('utf-8'))
        merce_dataset = "delete from merce_dataset where name = 'NewTable_time_1'"
        ms.ExecuNoQuery(merce_dataset.encode('utf-8'))
        merce_schema = "delete from merce_schema where data_source_names like 'gjb_mysql%' or data_source_names like 'gjb_hdfs%'"
        ms.ExecuNoQuery(merce_schema.encode('utf-8'))
        merce_dss = "delete from merce_dss where name = 'gjb_mysql' or name like 'gjb_hdfs%'"
        ms.ExecuNoQuery(merce_dss.encode('utf-8'))
        jar_package_info = "delete from merce_jar_package_info where name ='mysql-connector-java-8.0.2801.jar'"
        ms.ExecuNoQuery(jar_package_info.encode('utf-8'))
    except Exception as e:
        log.error("异常信息：%s" % e)

def delete_asset_directory(data):
    try:
        tenant_id = get_tenant_id()
        asset_directory = "select id from merce_resource_dir where tenant_id='%s' and res_type ='jobview_dir' and name like'%s%%%%' order by create_time desc limit 1" % (tenant_id, data)
        asset_directory_info = ms.ExecuQuery(asset_directory.encode('utf-8'))
        new_data = {"data":  str(asset_directory_info[0]["id"])}
        return asset_directory_info[0]["id"], new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def get_job_view(data):
    try:
        tenant_id = get_tenant_id()
        data = data.split("&")
        asset_directory = "select id from merce_resource_dir where tenant_id='%s' and res_type ='jobview_dir' and creator='admin' and name like'%s%%%%' order by create_time desc limit 1" % (tenant_id,data[0])
        asset_directory_info = ms.ExecuQuery(asset_directory.encode('utf-8'))
        s_c_job_pool = "select job_pool_oid,pool_name from s_c_job_pool where tenant_id='%s' and pool_name like'%s%%%%' limit 1" % (tenant_id,data[1])
        s_c_job_pool_info = ms.ExecuQuery(s_c_job_pool.encode('utf-8'))
        if data[2] == 'scheduler':
            new_data = {"name":  "gjb_scheduler随机数", "poolName":  s_c_job_pool_info[0]["pool_name"], "poolId":  s_c_job_pool_info[0]["job_pool_oid"], "sliceType":  "H", "enabled":  0, "description":  "自动化脚本", "resourceId":  asset_directory_info[0]["id"],"retryMax":1,"retryInterval":30}
            deal_random(new_data)
            return new_data
        elif data[2] == 'qa':
            new_data = {"name":  "gjb_qa_scheduler随机数", "poolName":  s_c_job_pool_info[0]["pool_name"], "poolId":  s_c_job_pool_info[0]["job_pool_oid"], "sliceType":  "H", "enabled":  0, "description":  "自动化脚本", "resourceId":  asset_directory_info[0]["id"],"retryMax":1,"retryInterval":30}
            deal_random(new_data)
            return new_data
        elif data[2] == 'dsp':
            new_data = {"name":  "gjb_dsp_scheduler随机数", "poolName":  s_c_job_pool_info[0]["pool_name"], "poolId":  s_c_job_pool_info[0]["job_pool_oid"], "sliceType":  "H", "enabled":  0, "description":  "自动化脚本", "resourceId":  asset_directory_info[0]["id"],"retryMax":1,"retryInterval":30}
            deal_random(new_data)
            return new_data
        else:
            return None
    except Exception as e:
        log.error("异常信息：%s" % e)


def get_job_view_exec(data):
    try:
        sql = "select id from s_v_job_view where name like'%s%%%%' order by create_time desc limit 1" % data
        job_info = ms.ExecuQuery(sql.encode('utf-8'))
        view_id = [job_info[0]["id"]]
        if data == 'gjb_scheduler':
            new_data = {"fieldGroup":{"type":"FieldGroup","group":True,"andOr":"AND","fields":[{"type":"Field","group":False,"andOr":"AND","name":"jobType","oper":"IN","value":[2],"label":""},{"type":"Field","group":False,"andOr":"AND","name":"viewId","oper":"EQUAL","value":view_id,"label":""}]},"ordSort":[{"name":"startTime","order":"DESC"}],"pageable":{"pageNum":1,"pageSize":20,"pageable":True}}
            return new_data
        elif data == 'gjb_qa_scheduler':
            new_data = {"fieldGroup":{"type":"FieldGroup","group":True,"andOr":"AND","fields":[{"type":"Field","group":False,"andOr":"AND","name":"jobType","oper":"IN","value":[4],"label":""},{"type":"Field","group":False,"andOr":"AND","name":"viewId","oper":"EQUAL","value":view_id,"label":""}]},"ordSort":[{"name":"startTime","order":"DESC"}],"pageable":{"pageNum":1,"pageSize":20,"pageable":True}}
            return new_data
        elif data == 'gjb_dsp_scheduler':
            new_data = {"fieldGroup":{"type":"FieldGroup","group":True,"andOr":"AND","fields":[{"type":"Field","group":False,"andOr":"AND","name":"jobType","oper":"IN","value":[3],"label":""},{"type":"Field","group":False,"andOr":"AND","name":"viewId","oper":"EQUAL","value":view_id,"label":""}]},"ordSort":[{"name":"startTime","order":"DESC"}],"pageable":{"pageNum":1,"pageSize":20,"pageable":True}}
            return new_data
        else:
            return None
    except Exception as e:
        log.error("异常信息：%s" % e)

def dc_collect_group(data):
    try:
        dc_c = "delete from poseidon_collecter where group_name like'%s%%%%' order by create_time desc" % data
        ms.ExecuNoQuery(dc_c.encode('utf-8'))
        c_group = "select id from merce_resource_dir where name like'%s%%%%' order by create_time desc limit 1" % data
        group_id = ms.ExecuQuery(c_group.encode('utf-8'))
        new_data = {"resourceId":group_id[0]["id"],"id":"","name":"gjb_c1随机数","secretKey":"","authType":0,"host":"192.168.1.95","port":22,"proxyPort":8989,"online":0,"restUri":"http://192.168.1.95:8989","user":"","password":"","status":0,"isCacheStatus":0,"properties":{"relativePath":"","inOrganization":"","inSystem":"","inReporter":"","inPhoneNumber":"","businessCompany":""}}
        deal_random(new_data)
        return new_data
    except Exception as e:
        log.error("异常信息：%s" % e)


def get_input_dataset(data):
    try:
        tenant_id = get_tenant_id()
        new_data = data.split("&")
        time.sleep(15)
        poseidon_task_draft = "select id from poseidon_task_draft where tenant_id='%s' and name like '%s%%%%' ORDER BY create_time desc limit 1" %(tenant_id,new_data[0])
        draft_id = ms.ExecuQuery(poseidon_task_draft.encode('utf-8'))
        dataset_sql = "select md.id,md.schema_id,md.name,md.datasource_id,md.datasource_name,ms.name as schema_name from merce_dataset md inner join merce_schema ms on md.schema_id=ms.id where md.storage='JDBC' and md.tenant_id='%s' and md.name='%s' order by md.create_time desc limit 1" %(tenant_id,new_data[1])
        dataset = ms.ExecuQuery(dataset_sql.encode('utf-8'))
        new_data = {"datasourceId":dataset[0]["datasource_id"],"datasourceName":dataset[0]["datasource_name"],"datasourceType":"DB","draftId":str(draft_id[0]["id"]),"nodes":[{"id":"","mode":0,"datasetId":dataset[0]["id"],"datasetName":dataset[0]["name"],"schemaId":dataset[0]["schema_id"],"schemaName":dataset[0]["schema_name"],"schemaTags":None,"schemaVersion":1,"type":0}],"type":0}
        return draft_id[0]["id"],new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def get_output_dataset(data):
    try:
        tenant_id = get_tenant_id()
        data = data.split("&")
        dss = "select id,name from merce_dss where tenant_id='%s' and name like '%s%%%%' ORDER BY create_time desc limit 1" %(tenant_id,data[1])
        dss = ms.ExecuQuery(dss.encode('utf-8'))
        draft_node_info = "select pd.id,pd.draft_id,pd.schema_id,pd.schema_name,pd.dataset_name from poseidon_draft_node_info pd inner join poseidon_task_draft pt on pt.id=pd.draft_id where pd.datasource_type='DB' and pt.name like '%s%%%%' ORDER BY pt.create_time desc limit 1" %data[0]
        draft_node_info = ms.ExecuQuery(draft_node_info.encode('utf-8'))
        new_data = {"datasourceId":dss[0]["id"],"datasourceName":dss[0]["name"],"datasourceType":"HDFS","extras":{"datasourceDBType":"HDFS","clusterId":"cluster1"},"draftId":str(draft_node_info[0]["draft_id"]),"nodes":[{"id":draft_node_info[0]["id"],"mode":0,"schemaId":draft_node_info[0]["schema_id"],"schemaName":draft_node_info[0]["schema_name"],"datasetName": draft_node_info[0]["dataset_name"],"schemaTags":[],"datasourceType":"","schemaVersion":1,"type":1}],"type":1}
        return draft_node_info[0]["draft_id"],new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def save_node_prop(data):
    try:
        tenant_id = get_tenant_id()
        draft_node_info = "select pd.id,pd.draft_id,pd.task_id,pd.schema_name ,pd.datasource_id from poseidon_draft_node_info pd inner join poseidon_task_draft pt on pt.id =pd.draft_id where pt.tenant_id='%s' and pd.datasource_type='HDFS' and pt.name like '%s%%%%' ORDER BY pt.create_time desc limit 1" %(tenant_id,data)
        draft_node_info = ms.ExecuQuery(draft_node_info.encode('utf-8'))
        new_data = {"schemaName":draft_node_info[0]["schema_name"],"properties":{"quoteChar":"","writeParallel":2,"lineSeparatorHex":"0A","fileMaxSizeMbs":1024,"format":"orc","rootPath":"/auto_test","fieldSeparatorHex":"2C","outputMode":"overwrite","readParallel":1,"fileCloseStrategy":0,"fileTimeoutSecs":30,"path": "/auto_test/"+draft_node_info[0]["schema_name"],"dynamicPath":"","pathMode":"recursive","header":"false","ackFileSuffix":"","outSlicePath":True,"sliceType":"H","joinPath":"/auto_test/"+draft_node_info[0]["schema_name"]+"/{yyyyMMddHH}","sliceTypeFormat":"yyyyMMddHH","charsetName":"UTF-8"},"sinkStrategy":{"overflowTimeoutSecs":10,"overflowCloseStrategy":0,"overflowEnable":False,"overflowSync":True,"overflowOutPath":"","overflowStoreTime":3600,"overflowMaxSizeMbs":1024},"type":1,"datasourceType":"HDFS","id":draft_node_info[0]["id"],"taskId":str(draft_node_info[0]["task_id"]),"draftId":str(draft_node_info[0]["draft_id"]),"datasourceId":draft_node_info[0]["datasource_id"],"extras":{"datasourceDBType":"HDFS","clusterId":"cluster1"},"mode":0,"datasourceDBType":"HDFS"}
        return draft_node_info[0]["draft_id"],new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def update_draft(data):
    try:
        tenant_id = get_tenant_id()
        draft_node_info = "select pd.id,pd.draft_id,pd.task_id,pd.schema_id,pd.schema_name ,pd.dataset_name,pd.dataset_id,pd.datasource_id,pd.datasource_name from poseidon_draft_node_info pd inner join poseidon_task_draft pt on pt.id =pd.draft_id where pt.tenant_id='%s' and pd.datasource_type='DB' and pt.name like '%s%%%%' ORDER BY pt.create_time desc limit 1" %(tenant_id,data)
        input_draft_node_info = ms.ExecuQuery(draft_node_info.encode('utf-8'))
        poseidon_task_draft = "select name,tenant_id,owner,creator ,editor_id,editor_name,last_modifier from poseidon_task_draft where tenant_id='%s' and name like '%s%%%%' limit 1" %(tenant_id,data)
        task_draft = ms.ExecuQuery(poseidon_task_draft.encode('utf-8'))
        draft_node_info = "select pd.id,pd.schema_name ,pd.dataset_name,pd.datasource_id,pd.datasource_name from poseidon_draft_node_info pd inner join poseidon_task_draft pt on pt.id =pd.draft_id where pt.tenant_id='%s' and pd.datasource_type='HDFS' and pt.name like '%s%%%%' ORDER BY pt.create_time desc limit 1" %(tenant_id,data)
        output_draft_node_info = ms.ExecuQuery(draft_node_info.encode('utf-8'))
        new_data = {"name":task_draft[0]["name"],"version":0,"tenantId":task_draft[0]["tenant_id"],"owner":task_draft[0]["owner"],"enabled":1,"creator":task_draft[0]["creator"],"createTime":data_now(),"lastModifier":task_draft[0]["last_modifier"],"lastModifiedTime":data_now(),"id":str(input_draft_node_info[0]["draft_id"]),"taskId":str(input_draft_node_info[0]["task_id"]),"description":"","draftPlate":{"paints":[{"datasourceId":input_draft_node_info[0]["datasource_id"],"datasourceName":input_draft_node_info[0]["datasource_name"],"datasourceType":"DB","extras":{"datasourceDBType":"Mysql"},"datasourceUrls":datasource_url,"draftId":str(input_draft_node_info[0]["draft_id"]),"id":"","nodes":[{"id":input_draft_node_info[0]["id"],"sourceId":"","draftId":0,"mode":1,"schemaId":input_draft_node_info[0]["schema_id"],"schemaName":input_draft_node_info[0]["schema_name"],"schemaVersion":1,"schemaTags":[],"type":0,"datasetName":input_draft_node_info[0]["dataset_name"],"datasetId":input_draft_node_info[0]["dataset_id"],"datasourceId":input_draft_node_info[0]["datasource_id"],"datasetFlag":0,"datasourceName":input_draft_node_info[0]["datasource_name"],"datasourceType":""}],"taskId":str(input_draft_node_info[0]["task_id"]),"type":0,"upDateId":1},{"datasourceId":output_draft_node_info[0]["datasource_id"],"datasourceName":output_draft_node_info[0]["datasource_name"],"datasourceType":"HDFS","extras":{"datasourceDBType":"HDFS","clusterId":"cluster1"},"datasourceUrls":hdfs_url,"draftId":str(input_draft_node_info[0]["draft_id"]),"id":"","nodes":[{"id":output_draft_node_info[0]["id"],"sourceId":input_draft_node_info[0]["id"],"draftId":0,"mode":0,"schemaId":"","schemaName":output_draft_node_info[0]["schema_name"],"schemaVersion":1,"schemaTags":[],"type":1,"datasetName":output_draft_node_info[0]["dataset_name"],"datasetId":"","datasourceId":output_draft_node_info[0]["datasource_id"],"datasetFlag":0,"datasourceName":output_draft_node_info[0]["datasource_name"],"datasourceType":"HDFS","extras":{"datasourceDBType":"HDFS","clusterId":"cluster1"}}],"taskId":str(input_draft_node_info[0]["task_id"]),"type":1,"upDateId":0}],"shines":[{"source":input_draft_node_info[0]["id"],"target":output_draft_node_info[0]["id"]}]},"editorId":task_draft[0]["editor_id"],"editorName":task_draft[0]["editor_name"],"locked":True,"startTime":data_now(),"endTime":None,"enable":True}
        return input_draft_node_info[0]["draft_id"],new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def update_info_list(data):
    try:
        tenant_id = get_tenant_id()
        draft_node_info = "select pd.id,pd.draft_id,pd.task_id,pd.schema_id,pd.schema_name ,pd.dataset_name,pd.datasource_id,pd.datasource_name ,pd.resource_id, pd.dataset_resource_id from poseidon_draft_node_info pd inner join poseidon_task_draft pt on pt.id =pd.draft_id where pt.tenant_id='%s' and pd.datasource_type='HDFS' and pt.name like '%s%%%%' ORDER BY pt.create_time desc limit 1" %(tenant_id,data)
        draft_node_info = ms.ExecuQuery(draft_node_info.encode('utf-8'))
        new_data = [{"id":draft_node_info[0]["id"],"taskId":str(draft_node_info[0]["task_id"]),"draftId":str(draft_node_info[0]["draft_id"]),"datasourceId":draft_node_info[0]["datasource_id"],"datasourceName":draft_node_info[0]["datasource_name"],"datasourceType":"HDFS","schemaId":"","schemaName":draft_node_info[0]["schema_name"],"schemaVersion":1,"datasetId":"","datasetName":draft_node_info[0]["dataset_name"],"resourceId":get_resourceid(resource_type[2]),"resourceName":"Schemas","resourcePath":"Schemas;","datasetResourceId":get_resourceid(resource_type[1]),"datasetResourceName":"Datasets","datasetResourcePath":"Datasets;","type":1,"datasetFlag":0,"optFields":""}]
        return draft_node_info[0]["draft_id"],new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def update_setting(data):
    try:
        data = data.split("&")
        tenant_id = get_tenant_id()
        poseidon_task_draft = "select id from poseidon_task_draft where tenant_id='%s' and name like '%s%%%%' ORDER BY create_time desc limit 1" %(tenant_id,data[0])
        task_draft = ms.ExecuQuery(poseidon_task_draft.encode('utf-8'))
        poseidon_collect = " select md.id,md.name,md.resource_id ,ms.name as group_name from poseidon_collecter md inner join merce_resource_dir ms on md.resource_id =ms.id where ms.tenant_id='%s' and ms.name like '%s%%%%' order by ms.create_time desc limit 1" %(tenant_id,data[1])
        poseidon_collect = ms.ExecuQuery(poseidon_collect.encode('utf-8'))
        new_data = {"draftId":str(task_draft[0]["id"]),"groupDirId":poseidon_collect[0]["resource_id"],"groupName":poseidon_collect[0]["group_name"],"collectorId":str(poseidon_collect[0]["id"]),"collectorName":poseidon_collect[0]["name"],"name":"","mode":"local","runningMode":"stand-alone","scheduleRule":"","scheduleType":0,"queue":"default","parallelism":1,"cacheStatusIp":"","jobManagerMemoryMB":0,"taskManagerMemoryMB":0,"envJavaOpts":"","clearOutData":True,"messageEnable":True,"mixTransforms":False,"retry":0,"overflow":"","storeServiceUrl":"","autoRetry":False,"retryCount":1,"retryInterval":5,"maxHeapMemory":"2G","minHeapMemory":"2G"}
        return task_draft[0]["id"],new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def publish_flow(data):
    try:
        data = data.split("#")
        sql = "select id, owner, tenant_id, creator, enabled, last_modifier, name, flow_type, resource_id from merce_flow where  name like'%s%%%%' order by create_time desc limit 1" % data[0]
        job_info = ms.ExecuQuery(sql.encode('utf-8'))
        dataset_sql = " select md.id,md.name,md.schema_id ,ms.name as schema_name from merce_dataset md inner join merce_schema ms on md.schema_id =ms.id where md.source='output' and md.name like '%s%%%%' order by md.last_modified_time desc limit 1"% data[1]
        dataset_info = ms.ExecuQuery(dataset_sql.encode('utf-8'))
        new_data = {"tenantId":job_info[0]["tenant_id"],"owner":job_info[0]["owner"],"name":job_info[0]["name"],"enabled":1,"creator":"admin","createTime":data_now(),"lastModifier":"admin","lastModifiedTime":data_now(),"id":job_info[0]["id"],"version":0,"resourceId":None,"isHide":None,"resource":None,"source":None,"steps":[{"id":"source_1","name":"source","type":"source","otherConfigurations":{"dataset-dateTo":"","dataset-dateFrom":"","dataset-paths":"","dataset-sql":"","interceptor":"","dataset":[{"rule":"set_1","ignoreMissingPath":False,"dataset":dataset_info[0]["name"],"datasetId":dataset_info[0]["id"],"storage":"HDFS"}],"schema":dataset_info[0]["schema_name"],"schemaId":dataset_info[0]["schema_id"]},"inputConfigurations":None,"outputConfigurations":{"output":[{"name":"vachar_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"date_Column","type":"date","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"double_Column","type":"double","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"float_Column","type":"float","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"int_Column","type":"int","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"banary_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"integer_Column","type":"int","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"bool_Column","type":"int","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"bit_Column","type":"int","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"blob_Column","type":"binary","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"char_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"longblob_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"longtext_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"text_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"year_Column","type":"date","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"real_Column","type":"double","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"numeric_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0}]},"warningList":None,"errorList":{},"libs":None,"flowId":None,"x":120,"y":180,"implementation":None,"uiConfigurations":{"output":["output"]}},{"id":"transform_1","name":"transform","type":"transform","otherConfigurations":{"interceptor":"","expressions":[{"value":"from_unixtime(CAST(current_timestamp() AS BIGINT),'yyyyMMddHH') as stime","_uuid_":"dynamic_1"}]},"inputConfigurations":{"input":[{"name":"vachar_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"date_Column","type":"date","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"double_Column","type":"double","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"float_Column","type":"float","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"int_Column","type":"int","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"banary_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"integer_Column","type":"int","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"bool_Column","type":"int","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"bit_Column","type":"int","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"blob_Column","type":"binary","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"char_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"longblob_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"longtext_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"text_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"year_Column","type":"date","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"real_Column","type":"double","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"numeric_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0}]},"outputConfigurations":{"output":[{"name":"stime","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"vachar_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"date_Column","type":"date","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"double_Column","type":"double","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"float_Column","type":"float","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"int_Column","type":"int","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"banary_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"integer_Column","type":"int","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"bool_Column","type":"int","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"bit_Column","type":"int","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"blob_Column","type":"binary","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"char_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"longblob_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"longtext_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"text_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"year_Column","type":"date","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"real_Column","type":"double","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"numeric_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0}]},"warningList":None,"errorList":{},"libs":None,"flowId":None,"x":320,"y":60,"implementation":None,"uiConfigurations":{"output":["output"],"input":["input"]}}],"links":[{"source":"source_1","sourceOutput":"output","target":"transform_1","targetInput":"input"},{"source":"transform_1","sourceOutput":"output","target":"sink_1","targetInput":"input"}],"flowType":"dataflow","parameters":[{"name":"source_dataset","category":"ref","refs":["source_1.dataset"],"defaultVal":"NewTable_time_1-output-6134","value":None,"description":"","_uuid_":"dynamic_2"},{"category":"ref","name":"source_schema","refs":["source_1.schema"],"defaultVal":"NewTable_time_1-sink-8219","description":""},{"category":"ref","name":"path","refs":["sink_1.path"],"defaultVal":"/auto_test/gjb_scheduler_sink/$stime","description":""}],"inputs":[],"outputs":[],"dependencies":[],"tags":[],"description":None,"tagObjs":None,"flowSource":None,"flowComments":None,"flowId":job_info[0]["id"],"editorId":job_info[0]["owner"],"editorName":"admin","locked":True,"startTime":data_now(),"endTime":None,"enable":True,"customParameter":[]}
        sink_data = {"id":"sink_1","name":"sink","type":"sink","otherConfigurations":{"isDisable":False,"clusterId":"cluster1","datasetType":"NORMAL","expiredTime":"","description":"","checkpointLocation":"","countWrittenRecord":"true","format":"csv","separator":",","quoteChar":"\"","escapeChar":"\\","path":"/auto_test/gjb_scheduler_sink/$stime","mode":"overwrite","outputMode":"","schedulerVal":"","schedulerUnit":"","trigger":"","nullValue":"","maxFileSize":"","maxFileNumber":"","sliceTimeColumn":"stime","idColumn":"","sliceType":"H","hdfsPartitionColumn":"","partitionType":"DateFormat","dateFormat":"","dateFrom":"","dateTo":"","datePeriod":"","dateUnit":"HOUR","partitionList":"","time":"s","schema":"gjb_scheduler_sink随机数","type":"HDFS","dataset":"gjb_scheduler_sink随机数","datasetId":"","schemaId":"","datasetResource":"","schemaResource":"","schemaVersion":"1","pathPrefix":"/auto_test/gjb_scheduler_sink"},"inputConfigurations":{"input":[{"name":"stime","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"vachar_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"date_Column","type":"date","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"double_Column","type":"double","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"float_Column","type":"float","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"int_Column","type":"int","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"banary_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"integer_Column","type":"int","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"bool_Column","type":"int","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"bit_Column","type":"int","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"blob_Column","type":"binary","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"char_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"longblob_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"longtext_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"text_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"year_Column","type":"date","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"real_Column","type":"double","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0},{"name":"numeric_Column","type":"string","alias":"","pkFlag":0,"length":0,"id":0,"formula":"","isCalc":0}]},"outputConfigurations":{},"warningList":None,"errorList":{},"libs":None,"flowId":None,"x":540,"y":190,"implementation":None,"uiConfigurations":{"input":["input"]}}
        other = {"isDisable":False,"clusterId":"cluster1","datasetType":"NORMAL","expiredTime":"","description":"","checkpointLocation":"","countWrittenRecord":"true","format":"csv","separator":",","quoteChar":"\"","escapeChar":"\\","path":"/auto_test/gjb_scheduler_sink/$stime","mode":"overwrite","outputMode":"","schedulerVal":"","schedulerUnit":"","trigger":"","nullValue":"","maxFileSize":"","maxFileNumber":"","sliceTimeColumn":"stime","idColumn":"","sliceType":"H","hdfsPartitionColumn":"","partitionType":"DateFormat","dateFormat":"","dateFrom":"","dateTo":"","datePeriod":"","dateUnit":"HOUR","partitionList":"","time":"s","schema":"gjb_scheduler_sink随机数","type":"HDFS","dataset":"gjb_scheduler_sink随机数","datasetId":"","schemaId":"","datasetResource":"","schemaResource":"","schemaVersion":"1","pathPrefix":"/auto_test/gjb_scheduler_sink"}
        deal_random(other)
        sink_data['otherConfigurations'] = other
        new_data['steps'].append(sink_data)
        return job_info[0]["id"], new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def get_jobview_history(data):
    try:
        data = data.split("&")
        tenant_id = get_tenant_id()
        dc_task = "select id,name from poseidon_task where tenant_id='%s' and name like'%s%%%%' order by create_time desc limit 1" % (tenant_id,data[0])
        dc_task = ms.ExecuQuery(dc_task.encode('utf-8'))
        print("dc_task", dc_task)
        sql = "select id, owner, tenant_id, name, pool_id, resource_id, slice_type from s_v_job_view where tenant_id='%s' and name like'%s%%%%' order by create_time desc limit 1" % (tenant_id,data[1])
        job_view = ms.ExecuQuery(sql.encode('utf-8'))
        print("job_view", job_view)
        source_flow_dataset_map = "select mfdm.dataset_id,mfdm.dataset_name,mfdm.flow_id,mfdm.flow_name from merce_flow_dataset_map mfdm inner join merce_flow mf on mf.id =mfdm.flow_id where mfdm.`type` ='source' and mf.tenant_id='%s' and mf.dev_stage='PRODUCTION' and mf.name like '%s%%%%' order by mf.create_time DESC limit 1" % (tenant_id,data[1])
        source_flow_dataset_map = ms.ExecuQuery(source_flow_dataset_map.encode('utf-8'))
        print("source_flow_dataset_map", source_flow_dataset_map)
        job_name = source_flow_dataset_map[0]["flow_name"]+"."+source_flow_dataset_map[0]["flow_id"]
        sink_flow_dataset_map = "select mfdm.dataset_id,mfdm.dataset_name,mfdm.flow_id,mfdm.flow_name from merce_flow_dataset_map mfdm inner join merce_flow mf on mf.id =mfdm.flow_id where mfdm.`type` ='sink' and mf.tenant_id='%s' and mf.dev_stage='PRODUCTION' and mf.name like '%s%%%%' order by mf.create_time DESC limit 1" % (tenant_id,data[1])
        sink_flow_dataset_map = ms.ExecuQuery(sink_flow_dataset_map.encode('utf-8'))
        print("source_flow_dataset_map", source_flow_dataset_map)
        s_c_re = "select re_oid from s_c_re where tenant_id='%s' and re_name like'%s%%%%' limit 1" % (tenant_id,data[2])
        s_c_re = ms.ExecuQuery(s_c_re.encode('utf-8'))
        print("1111",s_c_re)
        new_data = {"locked":True,"tenantId":job_view[0]["tenant_id"],"owner":job_view[0]["owner"],"name":job_view[0]["name"],"enabled":1,"creator":"admin","createTime":data_now(),"lastModifier":"admin","lastModifiedTime":data_now(),"id":"1022572394668679168","viewId":job_view[0]["id"],"version":-2,"poolId":job_view[0]["pool_id"],"sliceType":"H","nodes":[{"tenantId":"","owner":"","name":dc_task[0]["name"],"enabled":None,"creator":"","createTime":None,"lastModifier":"","lastModifiedTime":None,"id":"","x":110,"y":50,"uiName":"collect_1","nodeType":1,"viewHistoryId":"","jobId":dc_task[0]["id"],"jobType":1,"config":{"id":dc_task[0]["id"],"jobName":"","jobType":None,"sliceType":"H","status":None,"msgOid":None,"jsonOid":None,"strategyOid":None,"delayTime":None,"configStr":"","taskType":None,"taskLevel":None,"jobPoolOid":job_view[0]["pool_id"],"timeoutTime":None,"eqTimeRun":None,"reOid":None,"cdoFilterClass":"","isTrigger":"","handleOid":None,"handleName":"","filterConf":"","flowName":dc_task[0]["name"],"flowId":dc_task[0]["id"],"flowVer":None,"againType":"","againReOid":None,"maxRun":None,"flowConf":"","clusterName":"","hdfsName":"default","runTime":"","timeOrder":"","userExe":"","otherPars":"","jobDesc":"","createTime":None,"planId":None,"delayType":None,"clusterExeName":"","userCreate":"","otherPars1":"","otherPars2":"","poolSize":None,"poolType":None,"queueName":"","againQueueName":"","jobVarList":[],"reThList":[],"againReThList":[],"jsonStr":"","toolboxSchema":"","outputPath":[],"parId":"","kafkaStr":"","supplementStr":"","supplementStrExt":"","dataFormatMap":{},"singleType":0,"sliceTimeList":[],"maxSliceTime":None,"jisuanFazhi":0,"outTimeList":[],"runTimeSet":[]},"firstNode":1,"lastRunTime":None,"sources":[],"sinks":[{"tenantId":"","owner":"","name":source_flow_dataset_map[0]["dataset_name"],"enabled":None,"creator":"","createTime":None,"lastModifier":"","lastModifiedTime":None,"id":"","x":110,"y":180,"uiName":"sink_1","nodeType":3,"viewHistoryId":"","jobNodeId":"","datasetId":source_flow_dataset_map[0]["dataset_id"],"schemaId":None,"config":{"dataType":1,"batchEnd":1,"datasetClean":30,"schemaName":"","clusterName":"default","sliceType":"H","maxRowNum":None,"maxFileNum":None,"ccMaxSec":None,"id":None,"resourceId":"","jobDataOid":"","jobPoolOid":job_view[0]["pool_id"],"collect_1":[]},"jobNodeName":""}]},{"tenantId":"","owner":"","name":source_flow_dataset_map[0]["flow_name"],"enabled":None,"creator":"","createTime":None,"lastModifier":"","lastModifiedTime":None,"id":"","x":110,"y":440,"uiName":"dataFlow_1","nodeType":2,"viewHistoryId":"","jobId":"","jobType":2,"config":{"id":None,"jobName":job_name,"jobType":2,"sliceType":"H","status":None,"msgOid":None,"jsonOid":None,"strategyOid":2,"delayTime":1,"configStr":"100","taskType":5,"taskLevel":5,"jobPoolOid":job_view[0]["pool_id"],"timeoutTime":None,"eqTimeRun":None,"reOid":str(s_c_re[0]["re_oid"]),"cdoFilterClass":"","isTrigger":"R","handleOid":None,"handleName":"HDFS-HDFS","filterConf":"5","flowName":source_flow_dataset_map[0]["flow_name"],"flowId":source_flow_dataset_map[0]["flow_id"],"flowVer":1,"againType":"2","againReOid":None,"maxRun":None,"flowConf":"","clusterName":"default","hdfsName":"default","runTime":"","timeOrder":"1","userExe":"","otherPars":"","jobDesc":"","createTime":None,"planId":None,"delayType":1,"clusterExeName":"","userCreate":"","otherPars1":"","otherPars2":"","poolSize":None,"poolType":None,"queueName":"","againQueueName":"","jobVarList":[],"reThList":[],"againReThList":[],"jsonStr":"","toolboxSchema":"","outputPath":[],"parId":"","kafkaStr":"","supplementStr":"","supplementStrExt":"","dataFormatMap":{},"singleType":0,"sliceTimeList":[],"maxSliceTime":None,"jisuanFazhi":0,"outTimeList":[],"runTimeSet":[],"source_1":[]},"firstNode":2,"lastRunTime":None,"sources":[{"tenantId":"","owner":"","name":source_flow_dataset_map[0]["dataset_name"],"enabled":None,"creator":"","createTime":None,"lastModifier":"","lastModifiedTime":None,"id":"","x":110,"y":310,"uiName":"source_1","nodeType":4,"viewHistoryId":"","jobNodeId":"","datasetId":source_flow_dataset_map[0]["dataset_id"],"jobMapId":None,"config":{"sliceTimeRegType":1,"sliceTimeReg":"","mustLevel":3,"mustType":1,"mustPars":"","mustLine":None,"mustOuttime":None,"jobType":"","clusterName":"default","hdfsName":"default","id":None,"jobDataOid":"","jobOid":None,"jobName":"","dataformatName":"","sliceType":"H","sliceTimeRegList":[],"sliceTimeRegList2":[],"jobPoolOid":job_view[0]["pool_id"],"sink_1":[]},"jobNodeName":""}],"sinks":[{"tenantId":"","owner":"","name":sink_flow_dataset_map[0]["dataset_name"],"enabled":None,"creator":"","createTime":None,"lastModifier":"","lastModifiedTime":None,"id":"","x":110,"y":570,"uiName":"sink_2","nodeType":5,"viewHistoryId":"","jobNodeId":"","datasetId":sink_flow_dataset_map[0]["dataset_id"],"schemaId":None,"config":{"dataType":1,"batchEnd":1,"datasetClean":30,"schemaName":"","clusterName":"default","sliceType":"H","maxRowNum":"","maxFileNum":"","ccMaxSec":"","jobPoolOid":job_view[0]["pool_id"],"dataFlow_1":[]},"jobNodeName":""}]}],"links":[{"source":"collect_1","target":"sink_1"},{"source":"source_1","target":"dataFlow_1"},{"source":"dataFlow_1","target":"sink_2"},{"source":"sink_1","target":"source_1"}],"steps":[{"tenantId":"","owner":"","name":dc_task[0]["name"],"enabled":None,"creator":"","createTime":None,"lastModifier":"","lastModifiedTime":None,"id":"","x":110,"y":50,"uiName":"collect_1","nodeType":1,"viewHistoryId":"","jobId":dc_task[0]["id"],"jobType":1,"config":{"id":dc_task[0]["id"],"jobName":"","jobType":None,"sliceType":"H","status":None,"msgOid":None,"jsonOid":None,"strategyOid":None,"delayTime":None,"configStr":"","taskType":None,"taskLevel":None,"jobPoolOid":job_view[0]["pool_id"],"timeoutTime":None,"eqTimeRun":None,"reOid":None,"cdoFilterClass":"","isTrigger":"","handleOid":None,"handleName":"","filterConf":"","flowName":dc_task[0]["name"],"flowId":dc_task[0]["id"],"flowVer":None,"againType":"","againReOid":None,"maxRun":None,"flowConf":"","clusterName":"","hdfsName":"default","runTime":"","timeOrder":"","userExe":"","otherPars":"","jobDesc":"","createTime":None,"planId":None,"delayType":None,"clusterExeName":"","userCreate":"","otherPars1":"","otherPars2":"","poolSize":None,"poolType":None,"queueName":"","againQueueName":"","jobVarList":[],"reThList":[],"againReThList":[],"jsonStr":"","toolboxSchema":"","outputPath":[],"parId":"","kafkaStr":"","supplementStr":"","supplementStrExt":"","dataFormatMap":{},"singleType":0,"sliceTimeList":[],"maxSliceTime":None,"jisuanFazhi":0,"outTimeList":[],"runTimeSet":[]},"firstNode":1,"sources":[],"sinks":[{"tenantId":"","owner":"","name":source_flow_dataset_map[0]["dataset_name"],"enabled":None,"creator":"","createTime":None,"lastModifier":"","lastModifiedTime":None,"id":"","x":None,"y":None,"uiName":"sink_1","nodeType":3,"viewHistoryId":"","jobNodeId":"","datasetId":source_flow_dataset_map[0]["dataset_id"],"schemaId":None,"config":{"dataType":1,"batchEnd":1,"datasetClean":30,"schemaName":"","clusterName":"default","sliceType":"H","maxRowNum":None,"maxFileNum":None,"ccMaxSec":None,"id":None,"resourceId":"","jobDataOid":"","jobPoolOid":job_view[0]["pool_id"]},"jobNodeName":""}],"lastRunTime":None},{"tenantId":"","owner":"","name":source_flow_dataset_map[0]["dataset_name"],"enabled":None,"creator":"","createTime":None,"lastModifier":"","lastModifiedTime":None,"id":"","x":110,"y":180,"uiName":"sink_1","nodeType":3,"viewHistoryId":"","jobNodeId":"","datasetId":source_flow_dataset_map[0]["dataset_id"],"schemaId":None,"config":{"dataType":1,"batchEnd":1,"datasetClean":30,"schemaName":"","clusterName":"default","sliceType":"H","maxRowNum":None,"maxFileNum":None,"ccMaxSec":None,"id":None,"resourceId":"","jobDataOid":"","jobPoolOid":job_view[0]["pool_id"],"collect_1":[]},"jobNodeName":""},{"tenantId":"","owner":"","name":source_flow_dataset_map[0]["flow_name"],"enabled":None,"creator":"","createTime":None,"lastModifier":"","lastModifiedTime":None,"id":"","x":110,"y":440,"uiName":"dataFlow_1","nodeType":2,"viewHistoryId":"","jobId":"","jobType":2,"config":{"id":None,"jobName":job_name,"jobType":2,"sliceType":"H","status":None,"msgOid":None,"jsonOid":None,"strategyOid":2,"delayTime":1,"configStr":"100","taskType":5,"taskLevel":5,"jobPoolOid":job_view[0]["pool_id"],"timeoutTime":None,"eqTimeRun":None,"reOid":str(s_c_re[0]["re_oid"]),"cdoFilterClass":"","isTrigger":"R","handleOid":None,"handleName":"HDFS-HDFS","filterConf":"5","flowName":source_flow_dataset_map[0]["flow_name"],"flowId":source_flow_dataset_map[0]["flow_id"],"flowVer":1,"againType":"2","againReOid":None,"maxRun":None,"flowConf":"","clusterName":"default","hdfsName":"default","runTime":"","timeOrder":"1","userExe":"","otherPars":"","jobDesc":"","createTime":None,"planId":None,"delayType":1,"clusterExeName":"","userCreate":"","otherPars1":"","otherPars2":"","poolSize":None,"poolType":None,"queueName":"","againQueueName":"","jobVarList":[],"reThList":[],"againReThList":[],"jsonStr":"","toolboxSchema":"","outputPath":[],"parId":"","kafkaStr":"","supplementStr":"","supplementStrExt":"","dataFormatMap":{},"singleType":0,"sliceTimeList":[],"maxSliceTime":None,"jisuanFazhi":0,"outTimeList":[],"runTimeSet":[],"source_1":[]},"firstNode":2,"sources":[{"tenantId":"","owner":"","name":source_flow_dataset_map[0]["dataset_name"],"enabled":None,"creator":"","createTime":None,"lastModifier":"","lastModifiedTime":None,"id":"","x":None,"y":None,"uiName":"source_1","nodeType":4,"viewHistoryId":"","jobNodeId":"","datasetId":source_flow_dataset_map[0]["dataset_id"],"jobMapId":None,"config":{"sliceTimeRegType":1,"sliceTimeReg":"","mustLevel":3,"mustType":1,"mustPars":"","mustLine":None,"mustOuttime":None,"jobType":"","clusterName":"default","hdfsName":"default","id":None,"jobDataOid":"","jobOid":None,"jobName":"","dataformatName":"","sliceType":"H","sliceTimeRegList":[],"sliceTimeRegList2":[],"jobPoolOid":job_view[0]["pool_id"]},"jobNodeName":""}],"sinks":[{"tenantId":"","owner":"","name":sink_flow_dataset_map[0]["dataset_name"],"enabled":None,"creator":"","createTime":None,"lastModifier":"","lastModifiedTime":None,"id":"","x":None,"y":None,"uiName":"sink","nodeType":5,"viewHistoryId":"","jobNodeId":"","datasetId":sink_flow_dataset_map[0]["dataset_id"],"schemaId":None,"config":None,"jobNodeName":""}],"lastRunTime":None},{"tenantId":"","owner":"","name":source_flow_dataset_map[0]["dataset_name"],"enabled":None,"creator":"","createTime":None,"lastModifier":"","lastModifiedTime":None,"id":"","x":110,"y":310,"uiName":"source_1","nodeType":4,"viewHistoryId":"","jobNodeId":"","datasetId":source_flow_dataset_map[0]["dataset_id"],"jobMapId":None,"config":{"sliceTimeRegType":1,"sliceTimeReg":"","mustLevel":3,"mustType":1,"mustPars":"","mustLine":None,"mustOuttime":None,"jobType":"","clusterName":"default","hdfsName":"default","id":None,"jobDataOid":"","jobOid":None,"jobName":"","dataformatName":"","sliceType":"H","sliceTimeRegList":[],"sliceTimeRegList2":[],"jobPoolOid":job_view[0]["pool_id"],"sink_1":[]},"jobNodeName":""},{"tenantId":"","owner":"","name":sink_flow_dataset_map[0]["dataset_name"],"enabled":None,"creator":"","createTime":None,"lastModifier":"","lastModifiedTime":None,"id":"","x":110,"y":570,"uiName":"sink_2","nodeType":5,"viewHistoryId":"","jobNodeId":"","datasetId":sink_flow_dataset_map[0]["dataset_id"],"schemaId":None,"config":{"dataType":1,"batchEnd":1,"datasetClean":30,"schemaName":"","clusterName":"default","sliceType":"H","maxRowNum":"","maxFileNum":"","ccMaxSec":"","jobPoolOid":job_view[0]["pool_id"],"dataFlow_1":[]},"jobNodeName":""}]}
        return new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def get_qa_jobview_history(data):
    try:
        data = data.split("&")
        dc_task = "select id,name from poseidon_task where name like'%s%%%%' order by create_time desc limit 1" % data[0]
        dc_task = ms.ExecuQuery(dc_task.encode('utf-8'))
        sql = "select id, owner, tenant_id, name, pool_id, resource_id, slice_type from s_v_job_view where name like'%s%%%%' order by create_time desc limit 1" % data[1]
        job_view = ms.ExecuQuery(sql.encode('utf-8'))
        source_flow_dataset_map = "select mfdm.dataset_id,mfdm.dataset_name,mfdm.flow_id,mfdm.flow_name from merce_flow_dataset_map mfdm inner join merce_flow mf on mf.id =mfdm.flow_id where mfdm.`type` ='source' and mf.name like '%s%%%%' order by mf.create_time DESC limit 1" % data[2]
        source_flow_dataset_map = ms.ExecuQuery(source_flow_dataset_map.encode('utf-8'))
        job_name = source_flow_dataset_map[0]["flow_name"]+"."+source_flow_dataset_map[0]["flow_id"]
        s_c_re = "select re_oid from s_c_re where re_name like'%s%%%%' limit 1" % data[3]
        s_c_re = ms.ExecuQuery(s_c_re.encode('utf-8'))
        new_data = {"locked":True,"tenantId":job_view[0]["tenant_id"],"owner":job_view[0]["owner"],"name":job_view[0]["name"],"enabled":1,"creator":"admin","createTime":data_now(),"lastModifier":"admin","lastModifiedTime":data_now(),"id":"1024701663835512832","viewId":job_view[0]["id"],"version":-2,"poolId":job_view[0]["pool_id"],"sliceType":"H","nodes":[{"name":source_flow_dataset_map[0]["flow_name"],"id":"","uiName":"quality_1","nodeType":2,"jobType":4,"config":{"id":None,"jobName":job_name,"jobType":2,"sliceType":"H","status":None,"msgOid":None,"jsonOid":None,"strategyOid":0,"delayTime":1,"configStr":"100","taskType":5,"taskLevel":5,"jobPoolOid":job_view[0]["pool_id"],"timeoutTime":None,"eqTimeRun":None,"reOid":s_c_re[0]["re_oid"],"cdoFilterClass":"","isTrigger":"R","handleOid":None,"handleName":"HDFS-HDFS","filterConf":"5","flowName":source_flow_dataset_map[0]["flow_name"],"flowId":source_flow_dataset_map[0]["flow_id"],"flowVer":1,"againType":"2","againReOid":None,"maxRun":None,"flowConf":"","clusterName":"default","hdfsName":"default","runTime":"","timeOrder":"1","userExe":"","otherPars":"","jobDesc":"","createTime":None,"planId":None,"delayType":1,"clusterExeName":"","userCreate":"","otherPars1":"","otherPars2":"","jisuanFazhi":0,"source_1":[]},"firstNode":2,"x":110,"y":440,"sources":[{"name":source_flow_dataset_map[0]["dataset_name"],"uiName":"source_1","nodeType":4,"datasetId":source_flow_dataset_map[0]["dataset_id"],"config":{"sliceTimeRegType":1,"sliceTimeReg":"","mustLevel":3,"mustType":1,"mustPars":"","mustLine":None,"mustOuttime":None,"jobType":"","clusterName":"default","hdfsName":"default","id":None,"jobDataOid":"","jobOid":None,"jobName":"","dataformatName":"","jobPoolOid":job_view[0]["pool_id"],"sliceType":"H","sink_2":[]},"x":110,"y":310}],"sinks":[]},{"name":dc_task[0]["name"],"id":"","uiName":"collect_2","nodeType":1,"jobType":1,"config":{"id":dc_task[0]["id"],"jobName":"","jobType":None,"sliceType":"H","status":None,"msgOid":None,"jsonOid":None,"strategyOid":None,"delayTime":None,"configStr":"","taskType":None,"taskLevel":None,"jobPoolOid":job_view[0]["pool_id"],"timeoutTime":None,"eqTimeRun":None,"reOid":None,"cdoFilterClass":"","isTrigger":"","handleOid":None,"handleName":"","filterConf":"","flowName":dc_task[0]["name"],"flowId":dc_task[0]["id"],"flowVer":None,"againType":"","againReOid":None,"maxRun":None,"flowConf":"","clusterName":"","hdfsName":"default","runTime":"","timeOrder":"","userExe":"","otherPars":"","jobDesc":"","createTime":None,"planId":None,"delayType":None,"clusterExeName":"","userCreate":"","otherPars1":"","otherPars2":"","jisuanFazhi":0},"firstNode":1,"x":110,"y":50,"sources":[],"sinks":[{"name":source_flow_dataset_map[0]["dataset_name"],"uiName":"sink_2","nodeType":3,"datasetId":source_flow_dataset_map[0]["dataset_id"],"config":{"dataType":1,"batchEnd":1,"datasetClean":30,"schemaName":"","clusterName":"default","sliceType":"H","maxRowNum":None,"maxFileNum":None,"ccMaxSec":None,"id":None,"resourceId":"","jobDataOid":"","jobPoolOid":job_view[0]["pool_id"],"collect_2":[]},"x":110,"y":180}]}],"links":[{"source":"source_1","target":"quality_1"},{"source":"collect_2","target":"sink_2"},{"source":"sink_2","target":"source_1"}],"steps":[{"name":source_flow_dataset_map[0]["flow_name"],"id":"","uiName":"quality_1","nodeType":2,"jobType":4,"config":{"id":None,"jobName":job_name,"jobType":2,"sliceType":"H","status":None,"msgOid":None,"jsonOid":None,"strategyOid":0,"delayTime":1,"configStr":"100","taskType":5,"taskLevel":5,"jobPoolOid":job_view[0]["pool_id"],"timeoutTime":None,"eqTimeRun":None,"reOid":s_c_re[0]["re_oid"],"cdoFilterClass":"","isTrigger":"R","handleOid":None,"handleName":"HDFS-HDFS","filterConf":"5","flowName":source_flow_dataset_map[0]["flow_name"],"flowId":source_flow_dataset_map[0]["flow_id"],"flowVer":3,"againType":"2","againReOid":None,"maxRun":None,"flowConf":"","clusterName":"default","hdfsName":"default","runTime":"","timeOrder":"1","userExe":"","otherPars":"","jobDesc":"","createTime":None,"planId":None,"delayType":1,"clusterExeName":"","userCreate":"","otherPars1":"","otherPars2":"","jisuanFazhi":0,"source_1":[]},"firstNode":2,"sources":[{"name":source_flow_dataset_map[0]["dataset_name"],"uiName":"source_1","nodeType":4,"datasetId":source_flow_dataset_map[0]["dataset_id"],"config":{"sliceTimeRegType":1,"sliceTimeReg":"","mustLevel":3,"mustType":1,"mustPars":"","mustLine":None,"mustOuttime":None,"jobType":"","clusterName":"default","hdfsName":"default","id":None,"jobDataOid":"","jobOid":None,"jobName":"","dataformatName":"","jobPoolOid":job_view[0]["pool_id"],"sliceType":"H"}}],"sinks":[],"x":110,"y":440},{"name":source_flow_dataset_map[0]["dataset_name"],"uiName":"source_1","nodeType":4,"datasetId":source_flow_dataset_map[0]["dataset_id"],"config":{"sliceTimeRegType":1,"sliceTimeReg":"","mustLevel":3,"mustType":1,"mustPars":"","mustLine":None,"mustOuttime":None,"jobType":"","clusterName":"default","hdfsName":"default","id":None,"jobDataOid":"","jobOid":None,"jobName":"","dataformatName":"","jobPoolOid":job_view[0]['pool_id'],"sliceType":"H","sink_2":[]},"x":110,"y":310},{"name":dc_task[0]["name"],"id":"","uiName":"collect_2","nodeType":1,"jobType":1,"config":{"id":dc_task[0]["id"],"jobName":"","jobType":None,"sliceType":"H","status":None,"msgOid":None,"jsonOid":None,"strategyOid":None,"delayTime":None,"configStr":"","taskType":None,"taskLevel":None,"jobPoolOid":job_view[0]["pool_id"],"timeoutTime":None,"eqTimeRun":None,"reOid":None,"cdoFilterClass":"","isTrigger":"","handleOid":None,"handleName":"","filterConf":"","flowName":dc_task[0]["name"],"flowId":dc_task[0]["id"],"flowVer":None,"againType":"","againReOid":None,"maxRun":None,"flowConf":"","clusterName":"","hdfsName":"default","runTime":"","timeOrder":"","userExe":"","otherPars":"","jobDesc":"","createTime":None,"planId":None,"delayType":None,"clusterExeName":"","userCreate":"","otherPars1":"","otherPars2":"","jisuanFazhi":0},"firstNode":1,"sources":[],"sinks":[{"name":source_flow_dataset_map[0]["dataset_name"],"uiName":"sink_2","nodeType":3,"datasetId":source_flow_dataset_map[0]["dataset_id"],"config":{"dataType":1,"batchEnd":1,"datasetClean":30,"schemaName":"","clusterName":"default","sliceType":"H","maxRowNum":None,"maxFileNum":None,"ccMaxSec":None,"id":None,"resourceId":"","jobDataOid":"","jobPoolOid":job_view[0]["pool_id"]}}],"x":110,"y":50},{"name":source_flow_dataset_map[0]["dataset_name"],"uiName":"sink_2","nodeType":3,"datasetId":source_flow_dataset_map[0]["dataset_id"],"config":{"dataType":1,"batchEnd":1,"datasetClean":30,"schemaName":"","clusterName":"default","sliceType":"H","maxRowNum":None,"maxFileNum":None,"ccMaxSec":None,"id":None,"resourceId":"","jobDataOid":"","jobPoolOid":job_view[0]["pool_id"],"collect_2":[]},"x":110,"y":180}]}
        return new_data
    except Exception as e:
        log.error("异常信息：%s" % e)


def get_dsp_jobview_history(data):
    try:
        data = data.split("&")
        dc_task = "select id,name from poseidon_task where name like'%s%%%%' order by create_time desc limit 1" % data[0]
        dc_task = ms.ExecuQuery(dc_task.encode('utf-8'))
        sql = "select id, owner, tenant_id, name, pool_id, resource_id, slice_type from s_v_job_view where name like'%s%%%%' order by create_time desc limit 1" % data[1]
        job_view = ms.ExecuQuery(sql.encode('utf-8'))
        source_flow_dataset_map = "select mfdm.dataset_id,mfdm.dataset_name,mfdm.flow_id,mfdm.flow_name from merce_flow_dataset_map mfdm inner join merce_flow mf on mf.id =mfdm.flow_id where mfdm.`type` ='source' and mf.name like '%s%%%%' order by mf.create_time DESC limit 1" % data[2]
        source_flow_dataset_map = ms.ExecuQuery(source_flow_dataset_map.encode('utf-8'))
        job_name = source_flow_dataset_map[0]["flow_name"]+"."+source_flow_dataset_map[0]["flow_id"]
        s_c_re = "select re_oid from s_c_re where re_name like'%s%%%%' limit 1" % data[3]
        s_c_re = ms.ExecuQuery(s_c_re.encode('utf-8'))
        new_data = {"locked":True,"tenantId":job_view[0]["tenant_id"],"owner":job_view[0]["owner"],"name":job_view[0]["name"],"enabled":1,"creator":"admin","createTime":data_now(),"lastModifier":"admin","lastModifiedTime":data_now(),"id":"1024701663835512832","viewId":job_view[0]["id"],"version":-2,"poolId":job_view[0]["pool_id"],"sliceType":"H","nodes":[{"name":source_flow_dataset_map[0]["flow_name"],"id":"","uiName":"share_1","nodeType":2,"jobType":3,"config":{"id":None,"jobName":job_name,"jobType":2,"sliceType":"H","status":None,"msgOid":None,"jsonOid":None,"strategyOid":0,"delayTime":1,"configStr":"100","taskType":5,"taskLevel":5,"jobPoolOid":job_view[0]["pool_id"],"timeoutTime":None,"eqTimeRun":None,"reOid":s_c_re[0]["re_oid"],"cdoFilterClass":"","isTrigger":"R","handleOid":None,"handleName":"HDFS-HDFS","filterConf":"5","flowName":source_flow_dataset_map[0]["flow_name"],"flowId":source_flow_dataset_map[0]["flow_id"],"flowVer":1,"againType":"2","againReOid":None,"maxRun":None,"flowConf":"","clusterName":"default","hdfsName":"default","runTime":"","timeOrder":"1","userExe":"","otherPars":"","jobDesc":"","createTime":None,"planId":None,"delayType":1,"clusterExeName":"","userCreate":"","otherPars1":"","otherPars2":"","jisuanFazhi":0,"source_1":[]},"firstNode":2,"x":110,"y":440,"sources":[{"name":source_flow_dataset_map[0]["dataset_name"],"uiName":"source_1","nodeType":4,"datasetId":source_flow_dataset_map[0]["dataset_id"],"config":{"sliceTimeRegType":1,"sliceTimeReg":"","mustLevel":3,"mustType":1,"mustPars":"","mustLine":None,"mustOuttime":None,"jobType":"","clusterName":"default","hdfsName":"default","id":None,"jobDataOid":"","jobOid":None,"jobName":"","dataformatName":"","jobPoolOid":job_view[0]["pool_id"],"sliceType":"H","sink_2":[]},"x":110,"y":310}],"sinks":[]},{"name":dc_task[0]["name"],"id":"","uiName":"collect_2","nodeType":1,"jobType":1,"config":{"id":dc_task[0]["id"],"jobName":"","jobType":None,"sliceType":"H","status":None,"msgOid":None,"jsonOid":None,"strategyOid":None,"delayTime":None,"configStr":"","taskType":None,"taskLevel":None,"jobPoolOid":job_view[0]["pool_id"],"timeoutTime":None,"eqTimeRun":None,"reOid":None,"cdoFilterClass":"","isTrigger":"","handleOid":None,"handleName":"","filterConf":"","flowName":dc_task[0]["name"],"flowId":dc_task[0]["id"],"flowVer":None,"againType":"","againReOid":None,"maxRun":None,"flowConf":"","clusterName":"","hdfsName":"default","runTime":"","timeOrder":"","userExe":"","otherPars":"","jobDesc":"","createTime":None,"planId":None,"delayType":None,"clusterExeName":"","userCreate":"","otherPars1":"","otherPars2":"","jisuanFazhi":0},"firstNode":1,"x":110,"y":50,"sources":[],"sinks":[{"name":source_flow_dataset_map[0]["dataset_name"],"uiName":"sink_2","nodeType":3,"datasetId":source_flow_dataset_map[0]["dataset_id"],"config":{"dataType":1,"batchEnd":1,"datasetClean":30,"schemaName":"","clusterName":"default","sliceType":"H","maxRowNum":None,"maxFileNum":None,"ccMaxSec":None,"id":None,"resourceId":"","jobDataOid":"","jobPoolOid":job_view[0]["pool_id"],"collect_2":[]},"x":110,"y":180}]}],"links":[{"source":"source_1","target":"quality_1"},{"source":"collect_2","target":"sink_2"},{"source":"sink_2","target":"source_1"}],"steps":[{"name":source_flow_dataset_map[0]["flow_name"],"id":"","uiName":"share_1","nodeType":2,"jobType":3,"config":{"id":None,"jobName":job_name,"jobType":2,"sliceType":"H","status":None,"msgOid":None,"jsonOid":None,"strategyOid":0,"delayTime":1,"configStr":"100","taskType":5,"taskLevel":5,"jobPoolOid":job_view[0]["pool_id"],"timeoutTime":None,"eqTimeRun":None,"reOid":s_c_re[0]["re_oid"],"cdoFilterClass":"","isTrigger":"R","handleOid":None,"handleName":"HDFS-HDFS","filterConf":"5","flowName":source_flow_dataset_map[0]["flow_name"],"flowId":source_flow_dataset_map[0]["flow_id"],"flowVer":3,"againType":"2","againReOid":None,"maxRun":None,"flowConf":"","clusterName":"default","hdfsName":"default","runTime":"","timeOrder":"1","userExe":"","otherPars":"","jobDesc":"","createTime":None,"planId":None,"delayType":1,"clusterExeName":"","userCreate":"","otherPars1":"","otherPars2":"","jisuanFazhi":0,"source_1":[]},"firstNode":2,"sources":[{"name":source_flow_dataset_map[0]["dataset_name"],"uiName":"source_1","nodeType":4,"datasetId":source_flow_dataset_map[0]["dataset_id"],"config":{"sliceTimeRegType":1,"sliceTimeReg":"","mustLevel":3,"mustType":1,"mustPars":"","mustLine":None,"mustOuttime":None,"jobType":"","clusterName":"default","hdfsName":"default","id":None,"jobDataOid":"","jobOid":None,"jobName":"","dataformatName":"","jobPoolOid":job_view[0]["pool_id"],"sliceType":"H"}}],"sinks":[],"x":110,"y":440},{"name":source_flow_dataset_map[0]["dataset_name"],"uiName":"source_1","nodeType":4,"datasetId":source_flow_dataset_map[0]["dataset_id"],"config":{"sliceTimeRegType":1,"sliceTimeReg":"","mustLevel":3,"mustType":1,"mustPars":"","mustLine":None,"mustOuttime":None,"jobType":"","clusterName":"default","hdfsName":"default","id":None,"jobDataOid":"","jobOid":None,"jobName":"","dataformatName":"","jobPoolOid":job_view[0]['pool_id'],"sliceType":"H","sink_2":[]},"x":110,"y":310},{"name":dc_task[0]["name"],"id":"","uiName":"collect_2","nodeType":1,"jobType":1,"config":{"id":dc_task[0]["id"],"jobName":"","jobType":None,"sliceType":"H","status":None,"msgOid":None,"jsonOid":None,"strategyOid":None,"delayTime":None,"configStr":"","taskType":None,"taskLevel":None,"jobPoolOid":job_view[0]["pool_id"],"timeoutTime":None,"eqTimeRun":None,"reOid":None,"cdoFilterClass":"","isTrigger":"","handleOid":None,"handleName":"","filterConf":"","flowName":dc_task[0]["name"],"flowId":dc_task[0]["id"],"flowVer":None,"againType":"","againReOid":None,"maxRun":None,"flowConf":"","clusterName":"","hdfsName":"default","runTime":"","timeOrder":"","userExe":"","otherPars":"","jobDesc":"","createTime":None,"planId":None,"delayType":None,"clusterExeName":"","userCreate":"","otherPars1":"","otherPars2":"","jisuanFazhi":0},"firstNode":1,"sources":[],"sinks":[{"name":source_flow_dataset_map[0]["dataset_name"],"uiName":"sink_2","nodeType":3,"datasetId":source_flow_dataset_map[0]["dataset_id"],"config":{"dataType":1,"batchEnd":1,"datasetClean":30,"schemaName":"","clusterName":"default","sliceType":"H","maxRowNum":None,"maxFileNum":None,"ccMaxSec":None,"id":None,"resourceId":"","jobDataOid":"","jobPoolOid":job_view[0]["pool_id"]}}],"x":110,"y":50},{"name":source_flow_dataset_map[0]["dataset_name"],"uiName":"sink_2","nodeType":3,"datasetId":source_flow_dataset_map[0]["dataset_id"],"config":{"dataType":1,"batchEnd":1,"datasetClean":30,"schemaName":"","clusterName":"default","sliceType":"H","maxRowNum":None,"maxFileNum":None,"ccMaxSec":None,"id":None,"resourceId":"","jobDataOid":"","jobPoolOid":job_view[0]["pool_id"],"collect_2":[]},"x":110,"y":180}]}
        return new_data
    except Exception as e:
        log.error("异常信息：%s" % e)


def execution_task(data):
    try:
        poseidon_task = "select id from poseidon_task where name like'%s%%%%' order by create_time desc limit 1" % data
        poseidon_task = ms.ExecuQuery(poseidon_task.encode('utf-8'))
        taskid = [poseidon_task[0]["id"]]
        new_data = {"fieldGroup":{"type":"FieldGroup","group":True,"andOr":"AND","fields":[{"type":"Field","group":False,"andOr":"AND","name":"taskId","oper":"EQUAL","value":taskid,"label":""},{"type":"Field","group":False,"andOr":"AND","name":"parentId","oper":"EQUAL","value":["0"],"label":""}]},"ordSort":[{"name":"startTime","order":"DESC"}],"pageable":{"pageNum":1,"pageSize":20,"pageable":True}}
        return new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def qa_rule_task(data):
    try:
        tenant_id = get_tenant_id()
        data = data.split("&")
        dataset = "select id, owner,name from merce_dataset where source='output' and tenant_id ='%s' and name like'%s%%%%' order by create_time desc limit 1" % (tenant_id,data[0])
        dataset = ms.ExecuQuery(dataset.encode('utf-8'))
        dss = "select id,name from merce_dss where tenant_id ='%s' and name like'%s%%%%' order by create_time desc limit 1" % (tenant_id,data[1])
        dss = ms.ExecuQuery(dss.encode('utf-8'))
        qa_rule = "select id from qa_rule where tenant_id ='%s' and name ='字段联合空值校验' order by create_time desc limit 1"% tenant_id
        qa_rule = ms.ExecuQuery(qa_rule.encode('utf-8'))
        qa_rule1 = "select id from qa_rule where tenant_id ='%s' and name ='数据集空值行数规则' order by create_time desc limit 1"% tenant_id
        qa_rule1 = ms.ExecuQuery(qa_rule1.encode('utf-8'))
        new_data = {"jobType":"BATCH_DATASET","name":"gjb_qa_task随机数","responsibleId":dataset[0]["owner"],"responsibleName":"admin","description":"gjb_qa_task","schedulerType":"SINGLE","schedulerCycle":"","schedulerDelay":{"delay":0,"unit":"MINUTE"},"epStorageType":"DB","iterativeType":"FULL","ruleConf":{"datasetRuless":[{"dataset":{"datasetId":dataset[0]["id"],"datasetName":dataset[0]["name"]},"rules":[{"ruleId":qa_rule[0]["id"],"ruleName":"字段联合空值校验","version":1,"weights":1,"buildIn":1,"parameters":{"templateType":"T11","operator":"and","value":["double_Column","float_Column"],"alarmRanges":[0,25,50],"yellowValue":0,"orangeValue":25,"redValue":50}},{"ruleId":qa_rule1[0]["id"],"ruleName":"数据集空值行数规则","version":1,"weights":1,"buildIn":1,"parameters":{"templateType":"T2","alarmRanges":[0,25,50],"yellowValue":0,"orangeValue":25,"redValue":50}}],"increment":{"incrType":"PARTITION","incrUnit":"DAY","incrField":"","incrFormat":""}}],"datasetFieldRules":{"fieldRuless":[],"conditionSql":"","dimensions":[],"increment":None}},"notice":{"noticeTypes":["SYSTEM"],"noticeLevels":["ALARM","SUCCESS","FAIL"],"noticeMembers":[{"memberId":dataset[0]["owner"],"memberName":"admin"}],"noticeMembersName":[]},"isExceptionOut":1,"tempEntity":{"noticeMembers":["admin"],"datasets":dataset[0]["name"]},"exceptionOutConfig":{"normalOut":True,"retainCycle":1,"outPath":"NewTable","datasourceName":dss[0]["name"],"datasourceId":dss[0]["id"],"epDatasetResourceName":"数据集","epDatasetResourceId":get_resourceid(resource_type[1]),"schemaResourceName":"元数据","schemaResourceId":get_resourceid(resource_type[2]),"normalDatasetResourceName":"数据集","normalDatasetResourceId":get_resourceid(resource_type[1])},"resourceId":get_resourceid(resource_type[14])}
        deal_random(new_data)
        return new_data
    except Exception as e:
        log.error("异常信息：%s" % e)

def publish_qa_flow(data):
    try:
        tenant_id = get_tenant_id()
        data = data.split("#")
        sql = "select id, owner, tenant_id, creator, enabled, steps, parameters,links,name, flow_type, resource_id from merce_flow where tenant_id ='%s' and source='qualityanalysisflow' and name like'%s%%%%' order by create_time desc limit 1" % (tenant_id,data[0])
        job_info = ms.ExecuQuery(sql.encode('utf-8'))
        sql = "select id,name from qa_job where tenant_id='%s' and name like '%s%%%%' ORDER BY create_time desc limit 1" %(tenant_id,data[1])
        qa_task = ms.ExecuQuery(sql.encode('utf-8'))
        steps_str = parameter_ungzip(job_info[0]["steps"])
        steps_dict = json.loads(steps_str)
        parameters_str = parameter_ungzip(job_info[0]["parameters"])
        parameters_dict = json.loads(parameters_str)
        links_str = parameter_ungzip(job_info[0]["links"])
        links_dict = json.loads(links_str)
        new_data ={"tenantId":job_info[0]["tenant_id"],"owner":job_info[0]["owner"],"name":job_info[0]["name"],"enabled":1,"creator":"admin","createTime":data_now(),"lastModifier":"admin","lastModifiedTime":data_now(),"id":job_info[0]["id"],"version":0,"resourceId":job_info[0]["resource_id"],"isHide":1,"resource":None,"source":"qualityanalysisflow","steps":[{"id":"source_1","name":"source_1_","type":"source","otherConfigurations":{"dataset-dateTo":"","schemaVersion":1,"dataset-dateFrom":"","dataset-paths":"","dataset-sql":"","schemaId":"","interceptor":"","schemaName":"NewTable_time_1-sink-6304","dataset":[{"datasetId":"1245815004148105216","ignoreMissingPath":False,"rule":"set_1","storage":"HDFS","dataset":""}]},"inputConfigurations":None,"outputConfigurations":{"output":[{"name":"vachar_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109762","formula":"","isCalc":0},{"name":"date_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109764","formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109766","formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109768","formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109770","formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109772","formula":"","isCalc":0},{"name":"double_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109774","formula":"","isCalc":0},{"name":"float_Column","type":"float","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109776","formula":"","isCalc":0},{"name":"int_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109778","formula":"","isCalc":0},{"name":"banary_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109780","formula":"","isCalc":0},{"name":"integer_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109782","formula":"","isCalc":0},{"name":"bool_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109784","formula":"","isCalc":0},{"name":"bit_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109786","formula":"","isCalc":0},{"name":"blob_Column","type":"binary","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109788","formula":"","isCalc":0},{"name":"char_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109790","formula":"","isCalc":0},{"name":"longblob_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109792","formula":"","isCalc":0},{"name":"longtext_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109794","formula":"","isCalc":0},{"name":"text_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109796","formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109798","formula":"","isCalc":0},{"name":"year_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109800","formula":"","isCalc":0},{"name":"real_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109802","formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109804","formula":"","isCalc":0},{"name":"numeric_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109806","formula":"","isCalc":0}]},"warningList":None,"errorList":None,"libs":None,"flowId":None,"x":120,"y":120,"implementation":None,"uiConfigurations":{"output":["output"]}},{"id":"sql_1","name":"sql_1_NewTable_time_1-output-1737","type":"sql","otherConfigurations":{"interceptor":"","sql":"select to_json(struct(*)) as value from( select #{executionId:0} as executionId,#{bizdate:20220430} as bizdate,coalesce(count(1),0) as inputRecords,'1245815004148105216' as sourceDatasetId,coalesce(sum(case when (IsEmpty(vachar_Column) or IsEmpty(date_Column) or IsEmpty(timestamp_Column) or IsEmpty(datetime_Column) or IsEmpty(bigint_column) or IsEmpty(decimal_Column) or IsEmpty(double_Column) or IsEmpty(float_Column) or IsEmpty(int_Column) or IsEmpty(banary_Column) or IsEmpty(integer_Column) or IsEmpty(bool_Column) or IsEmpty(bit_Column) or IsEmpty(blob_Column) or IsEmpty(char_Column) or IsEmpty(longblob_Column) or IsEmpty(longtext_Column) or IsEmpty(text_Column) or IsEmpty(time_Column) or IsEmpty(year_Column) or IsEmpty(real_Column) or IsEmpty(double_precision_Column) or IsEmpty(numeric_Column)) then 1 else 0 end),0) as rule_0,coalesce(sum(case when (IsEmpty(double_Column) and IsEmpty(float_Column)) then 1 else 0 end),0) as rule_1 from input )"},"inputConfigurations":{"input":[{"name":"vachar_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109762","formula":"","isCalc":0},{"name":"date_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109764","formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109766","formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109768","formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109770","formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109772","formula":"","isCalc":0},{"name":"double_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109774","formula":"","isCalc":0},{"name":"float_Column","type":"float","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109776","formula":"","isCalc":0},{"name":"int_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109778","formula":"","isCalc":0},{"name":"banary_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109780","formula":"","isCalc":0},{"name":"integer_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109782","formula":"","isCalc":0},{"name":"bool_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109784","formula":"","isCalc":0},{"name":"bit_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109786","formula":"","isCalc":0},{"name":"blob_Column","type":"binary","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109788","formula":"","isCalc":0},{"name":"char_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109790","formula":"","isCalc":0},{"name":"longblob_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109792","formula":"","isCalc":0},{"name":"longtext_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109794","formula":"","isCalc":0},{"name":"text_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109796","formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109798","formula":"","isCalc":0},{"name":"year_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109800","formula":"","isCalc":0},{"name":"real_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109802","formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109804","formula":"","isCalc":0},{"name":"numeric_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109806","formula":"","isCalc":0}]},"outputConfigurations":{"output":[{"name":"value","type":"string","types":None,"alias":None,"description":"输出字段的压缩值","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1243266012781445120","formula":"","isCalc":0}]},"warningList":None,"errorList":None,"libs":None,"flowId":None,"x":240,"y":120,"implementation":None,"uiConfigurations":{"output":["output"],"input":["input"]}},{"id":"sink_1","name":"sink_1","type":"sink","otherConfigurations":{"schema":"baymax_95_167_rocketmq_new_release_quality_analysis_sink001","brokers":"192.168.1.65:9095","schemaVersion":3,"schemaResource":"Schemas;qa;","zookeeper":"locahost:2181","datasetResourceId":"1103710450228101120","format":"json","isKerberosSupport":False,"storage":"KAFKA","type":"KAFKA","separator":",","nullValue":"","datasetResource":"Datasets;qa;","mode":"append","quote":"\"","countWrittenRecord":True,"schemaId":"1244595379243548672","topic":"baymax_95_167_rocketmq_new_release_quality_analysis_sink001","datasetId":"1244595379021250560","datasetType":"NORMAL","escape":"\\","dataset":"baymax_95_167_rocketmq_new_release_quality_analysis_sink001","schemaResourceId":"1103710450471370752"},"inputConfigurations":{"input":[{"name":"value","type":"string","types":None,"alias":None,"description":"输出字段的压缩值","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1243266012781445120","formula":"","isCalc":0}]},"outputConfigurations":{},"warningList":None,"errorList":None,"libs":None,"flowId":None,"x":360,"y":120,"implementation":None,"uiConfigurations":{"input":["input"]}},{"id":"source_2","name":"source_2_NewTable_time_1-output-1737","type":"source","otherConfigurations":{"dataset-dateTo":"","schemaVersion":1,"dataset-dateFrom":"","dataset-paths":"","dataset-sql":"","schemaId":"1245815004068413440","interceptor":"","schemaName":"NewTable_time_1-sink-6304","dataset":[{"datasetId":"1245815004148105216","ignoreMissingPath":False,"rule":"set_1","storage":"HDFS","dataset":"NewTable_time_1-output-1737"}]},"inputConfigurations":None,"outputConfigurations":{"output":[{"name":"vachar_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109762","formula":"","isCalc":0},{"name":"date_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109764","formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109766","formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109768","formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109770","formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109772","formula":"","isCalc":0},{"name":"double_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109774","formula":"","isCalc":0},{"name":"float_Column","type":"float","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109776","formula":"","isCalc":0},{"name":"int_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109778","formula":"","isCalc":0},{"name":"banary_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109780","formula":"","isCalc":0},{"name":"integer_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109782","formula":"","isCalc":0},{"name":"bool_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109784","formula":"","isCalc":0},{"name":"bit_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109786","formula":"","isCalc":0},{"name":"blob_Column","type":"binary","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109788","formula":"","isCalc":0},{"name":"char_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109790","formula":"","isCalc":0},{"name":"longblob_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109792","formula":"","isCalc":0},{"name":"longtext_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109794","formula":"","isCalc":0},{"name":"text_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109796","formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109798","formula":"","isCalc":0},{"name":"year_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109800","formula":"","isCalc":0},{"name":"real_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109802","formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109804","formula":"","isCalc":0},{"name":"numeric_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109806","formula":"","isCalc":0}]},"warningList":None,"errorList":None,"libs":None,"flowId":None,"x":120,"y":120,"implementation":None,"uiConfigurations":{"output":["output"]}},{"id":"transform_1","name":"transform_1","type":"transform","otherConfigurations":{"expressions":[{"value":"concat_ws(',',(case when (IsEmpty(vachar_Column) or IsEmpty(date_Column) or IsEmpty(timestamp_Column) or IsEmpty(datetime_Column) or IsEmpty(bigint_column) or IsEmpty(decimal_Column) or IsEmpty(double_Column) or IsEmpty(float_Column) or IsEmpty(int_Column) or IsEmpty(banary_Column) or IsEmpty(integer_Column) or IsEmpty(bool_Column) or IsEmpty(bit_Column) or IsEmpty(blob_Column) or IsEmpty(char_Column) or IsEmpty(longblob_Column) or IsEmpty(longtext_Column) or IsEmpty(text_Column) or IsEmpty(time_Column) or IsEmpty(year_Column) or IsEmpty(real_Column) or IsEmpty(double_precision_Column) or IsEmpty(numeric_Column)) then '数据集空值行数规则' else null end),(case when (IsEmpty(double_Column) and IsEmpty(float_Column)) then '字段联合空值校验' else null end)) as abnormal_rules"}]},"inputConfigurations":{"input":[{"name":"vachar_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109762","formula":"","isCalc":0},{"name":"date_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109764","formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109766","formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109768","formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109770","formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109772","formula":"","isCalc":0},{"name":"double_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109774","formula":"","isCalc":0},{"name":"float_Column","type":"float","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109776","formula":"","isCalc":0},{"name":"int_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109778","formula":"","isCalc":0},{"name":"banary_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109780","formula":"","isCalc":0},{"name":"integer_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109782","formula":"","isCalc":0},{"name":"bool_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109784","formula":"","isCalc":0},{"name":"bit_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109786","formula":"","isCalc":0},{"name":"blob_Column","type":"binary","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109788","formula":"","isCalc":0},{"name":"char_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109790","formula":"","isCalc":0},{"name":"longblob_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109792","formula":"","isCalc":0},{"name":"longtext_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109794","formula":"","isCalc":0},{"name":"text_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109796","formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109798","formula":"","isCalc":0},{"name":"year_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109800","formula":"","isCalc":0},{"name":"real_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109802","formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109804","formula":"","isCalc":0},{"name":"numeric_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109806","formula":"","isCalc":0}]},"outputConfigurations":{"output":[{"name":"vachar_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109762","formula":"","isCalc":0},{"name":"date_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109764","formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109766","formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109768","formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109770","formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109772","formula":"","isCalc":0},{"name":"double_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109774","formula":"","isCalc":0},{"name":"float_Column","type":"float","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109776","formula":"","isCalc":0},{"name":"int_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109778","formula":"","isCalc":0},{"name":"banary_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109780","formula":"","isCalc":0},{"name":"integer_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109782","formula":"","isCalc":0},{"name":"bool_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109784","formula":"","isCalc":0},{"name":"bit_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109786","formula":"","isCalc":0},{"name":"blob_Column","type":"binary","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109788","formula":"","isCalc":0},{"name":"char_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109790","formula":"","isCalc":0},{"name":"longblob_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109792","formula":"","isCalc":0},{"name":"longtext_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109794","formula":"","isCalc":0},{"name":"text_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109796","formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109798","formula":"","isCalc":0},{"name":"year_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109800","formula":"","isCalc":0},{"name":"real_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109802","formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109804","formula":"","isCalc":0},{"name":"numeric_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109806","formula":"","isCalc":0},{"name":"abnormal_rules","type":"string","types":None,"alias":None,"description":None,"pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0}]},"warningList":None,"errorList":None,"libs":None,"flowId":None,"x":120,"y":240,"implementation":None,"uiConfigurations":{"output":["output"],"input":["input"]}},{"id":"filter_1","name":"filter_1","type":"filter","otherConfigurations":{"condition":"abnormal_rules != ''","interceptor":""},"inputConfigurations":{"input":[{"name":"vachar_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109762","formula":"","isCalc":0},{"name":"date_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109764","formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109766","formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109768","formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109770","formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109772","formula":"","isCalc":0},{"name":"double_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109774","formula":"","isCalc":0},{"name":"float_Column","type":"float","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109776","formula":"","isCalc":0},{"name":"int_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109778","formula":"","isCalc":0},{"name":"banary_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109780","formula":"","isCalc":0},{"name":"integer_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109782","formula":"","isCalc":0},{"name":"bool_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109784","formula":"","isCalc":0},{"name":"bit_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109786","formula":"","isCalc":0},{"name":"blob_Column","type":"binary","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109788","formula":"","isCalc":0},{"name":"char_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109790","formula":"","isCalc":0},{"name":"longblob_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109792","formula":"","isCalc":0},{"name":"longtext_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109794","formula":"","isCalc":0},{"name":"text_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109796","formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109798","formula":"","isCalc":0},{"name":"year_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109800","formula":"","isCalc":0},{"name":"real_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109802","formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109804","formula":"","isCalc":0},{"name":"numeric_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109806","formula":"","isCalc":0},{"name":"abnormal_rules","type":"string","types":None,"alias":None,"description":None,"pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0}]},"outputConfigurations":{"output":[{"name":"vachar_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109762","formula":"","isCalc":0},{"name":"date_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109764","formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109766","formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109768","formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109770","formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109772","formula":"","isCalc":0},{"name":"double_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109774","formula":"","isCalc":0},{"name":"float_Column","type":"float","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109776","formula":"","isCalc":0},{"name":"int_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109778","formula":"","isCalc":0},{"name":"banary_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109780","formula":"","isCalc":0},{"name":"integer_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109782","formula":"","isCalc":0},{"name":"bool_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109784","formula":"","isCalc":0},{"name":"bit_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109786","formula":"","isCalc":0},{"name":"blob_Column","type":"binary","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109788","formula":"","isCalc":0},{"name":"char_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109790","formula":"","isCalc":0},{"name":"longblob_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109792","formula":"","isCalc":0},{"name":"longtext_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109794","formula":"","isCalc":0},{"name":"text_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109796","formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109798","formula":"","isCalc":0},{"name":"year_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109800","formula":"","isCalc":0},{"name":"real_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109802","formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109804","formula":"","isCalc":0},{"name":"numeric_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109806","formula":"","isCalc":0},{"name":"abnormal_rules","type":"string","types":None,"alias":None,"description":None,"pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0}]},"warningList":None,"errorList":None,"libs":None,"flowId":None,"x":360,"y":360,"implementation":None,"uiConfigurations":{"output":["output"],"input":["input"]}},{"id":"sink_2","name":"sink_2","type":"sink","otherConfigurations":{"schema":"gjb_qa_task1_NewTable_time_1-output-1737_abnormal","storage":"JDBC","DBType":"Mysql","type":"JDBC","batchsize":1000,"datasetResource":"Datasets;","mode":"overwrite","password":"a$2d53331db20714bc0564403b470c3efa~","countWrittenRecord":True,"paraPrefix":"?","datasetId":"1246108302524776448","id":"1245814902225862656","datasetType":"NORMAL","table":"E_1245815004148105216","schemaResourceId":"1093986569667706880","schemaVersion":1,"schemaResource":"Schemas;","datasetResourceId":"1093986569218916352","jarPath":"mysql-connector-j-8.0.32-internal-cluster1.jar","caseSensitive":"false","paraSep":"&","url":"jdbc:mysql://192.168.1.82:3306/auto_apitest","driver":"com.mysql.cj.jdbc.Driver","port":"3306","disable":False,"schemaId":"1246108302663188480","isolationLevel":"READ_UNCOMMITTED","name":"gjb_mysql","dbtype":"Mysql","user":"merce","dataset":"gjb_qa_task1_NewTable_time_1-output-1737_abnormal"},"inputConfigurations":{"input":[{"name":"vachar_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109762","formula":"","isCalc":0},{"name":"date_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109764","formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109766","formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109768","formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109770","formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109772","formula":"","isCalc":0},{"name":"double_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109774","formula":"","isCalc":0},{"name":"float_Column","type":"float","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109776","formula":"","isCalc":0},{"name":"int_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109778","formula":"","isCalc":0},{"name":"banary_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109780","formula":"","isCalc":0},{"name":"integer_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109782","formula":"","isCalc":0},{"name":"bool_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109784","formula":"","isCalc":0},{"name":"bit_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109786","formula":"","isCalc":0},{"name":"blob_Column","type":"binary","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109788","formula":"","isCalc":0},{"name":"char_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109790","formula":"","isCalc":0},{"name":"longblob_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109792","formula":"","isCalc":0},{"name":"longtext_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109794","formula":"","isCalc":0},{"name":"text_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109796","formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109798","formula":"","isCalc":0},{"name":"year_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109800","formula":"","isCalc":0},{"name":"real_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109802","formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109804","formula":"","isCalc":0},{"name":"numeric_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109806","formula":"","isCalc":0},{"name":"abnormal_rules","type":"string","types":None,"alias":None,"description":"异常规则","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1246108302608662528","formula":"","isCalc":0}]},"outputConfigurations":{},"warningList":None,"errorList":None,"libs":None,"flowId":None,"x":360,"y":120,"implementation":None,"uiConfigurations":{"input":["input"]}},{"id":"filter_2","name":"filter_2","type":"filter","otherConfigurations":{"condition":"abnormal_rules = ''","interceptor":""},"inputConfigurations":{"input":[{"name":"vachar_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109762","formula":"","isCalc":0},{"name":"date_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109764","formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109766","formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109768","formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109770","formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109772","formula":"","isCalc":0},{"name":"double_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109774","formula":"","isCalc":0},{"name":"float_Column","type":"float","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109776","formula":"","isCalc":0},{"name":"int_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109778","formula":"","isCalc":0},{"name":"banary_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109780","formula":"","isCalc":0},{"name":"integer_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109782","formula":"","isCalc":0},{"name":"bool_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109784","formula":"","isCalc":0},{"name":"bit_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109786","formula":"","isCalc":0},{"name":"blob_Column","type":"binary","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109788","formula":"","isCalc":0},{"name":"char_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109790","formula":"","isCalc":0},{"name":"longblob_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109792","formula":"","isCalc":0},{"name":"longtext_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109794","formula":"","isCalc":0},{"name":"text_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109796","formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109798","formula":"","isCalc":0},{"name":"year_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109800","formula":"","isCalc":0},{"name":"real_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109802","formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109804","formula":"","isCalc":0},{"name":"numeric_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109806","formula":"","isCalc":0},{"name":"abnormal_rules","type":"string","types":None,"alias":None,"description":None,"pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0}]},"outputConfigurations":{"output":[{"name":"vachar_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109762","formula":"","isCalc":0},{"name":"date_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109764","formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109766","formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109768","formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109770","formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109772","formula":"","isCalc":0},{"name":"double_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109774","formula":"","isCalc":0},{"name":"float_Column","type":"float","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109776","formula":"","isCalc":0},{"name":"int_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109778","formula":"","isCalc":0},{"name":"banary_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109780","formula":"","isCalc":0},{"name":"integer_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109782","formula":"","isCalc":0},{"name":"bool_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109784","formula":"","isCalc":0},{"name":"bit_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109786","formula":"","isCalc":0},{"name":"blob_Column","type":"binary","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109788","formula":"","isCalc":0},{"name":"char_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109790","formula":"","isCalc":0},{"name":"longblob_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109792","formula":"","isCalc":0},{"name":"longtext_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109794","formula":"","isCalc":0},{"name":"text_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109796","formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109798","formula":"","isCalc":0},{"name":"year_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109800","formula":"","isCalc":0},{"name":"real_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109802","formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109804","formula":"","isCalc":0},{"name":"numeric_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109806","formula":"","isCalc":0},{"name":"abnormal_rules","type":"string","types":None,"alias":None,"description":None,"pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0}]},"warningList":None,"errorList":None,"libs":None,"flowId":None,"x":360,"y":360,"implementation":None,"uiConfigurations":{"output":["output"],"input":["input"]}},{"id":"sink_3","name":"sink_3","type":"sink","otherConfigurations":{"schema":"NewTable_time_1-sink-6304","storage":"JDBC","DBType":"Mysql","type":"JDBC","batchsize":1000,"datasetResource":"Datasets;","mode":"overwrite","password":"a$2d53331db20714bc0564403b470c3efa~","countWrittenRecord":True,"paraPrefix":"?","datasetId":"1246108303556575232","id":"1245814902225862656","datasetType":"NORMAL","table":"R_1245815004148105216","schemaResourceId":"1093986569667706880","schemaVersion":1,"schemaResource":"Schemas;","datasetResourceId":"1093986569218916352","jarPath":"mysql-connector-j-8.0.32-internal-cluster1.jar","caseSensitive":"false","paraSep":"&","url":"jdbc:mysql://192.168.1.82:3306/auto_apitest","driver":"com.mysql.cj.jdbc.Driver","port":"3306","disable":False,"schemaId":"1245815004068413440","isolationLevel":"READ_UNCOMMITTED","name":"gjb_mysql","dbtype":"Mysql","user":"merce","dataset":"gjb_qa_task1_NewTable_time_1-output-1737_normal"},"inputConfigurations":{"input":[{"name":"vachar_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109762","formula":"","isCalc":0},{"name":"date_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109764","formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109766","formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109768","formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109770","formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109772","formula":"","isCalc":0},{"name":"double_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109774","formula":"","isCalc":0},{"name":"float_Column","type":"float","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109776","formula":"","isCalc":0},{"name":"int_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109778","formula":"","isCalc":0},{"name":"banary_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109780","formula":"","isCalc":0},{"name":"integer_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109782","formula":"","isCalc":0},{"name":"bool_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109784","formula":"","isCalc":0},{"name":"bit_Column","type":"int","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109786","formula":"","isCalc":0},{"name":"blob_Column","type":"binary","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109788","formula":"","isCalc":0},{"name":"char_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109790","formula":"","isCalc":0},{"name":"longblob_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109792","formula":"","isCalc":0},{"name":"longtext_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109794","formula":"","isCalc":0},{"name":"text_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109796","formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109798","formula":"","isCalc":0},{"name":"year_Column","type":"date","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109800","formula":"","isCalc":0},{"name":"real_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109802","formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109804","formula":"","isCalc":0},{"name":"numeric_Column","type":"string","types":None,"alias":None,"description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":"1245814940965109806","formula":"","isCalc":0}]},"outputConfigurations":{},"warningList":None,"errorList":None,"libs":None,"flowId":None,"x":360,"y":120,"implementation":None,"uiConfigurations":{"input":["input"]}}],"links":[{"source":"source_1","sourceOutput":"output","target":"sql_1","targetInput":"input"},{"source":"sql_1","sourceOutput":"output","target":"sink_1","targetInput":"input"},{"source":"source_2","sourceOutput":"output","target":"transform_1","targetInput":"input"},{"source":"transform_1","sourceOutput":"output","target":"filter_1","targetInput":"input"},{"source":"filter_1","sourceOutput":"output","target":"sink_2","targetInput":"input"},{"source":"transform_1","sourceOutput":"output","target":"filter_2","targetInput":"input"},{"source":"filter_2","sourceOutput":"output","target":"sink_3","targetInput":"input"}],"flowType":"dataflow","parameters":[{"category":"ref","name":"source_dataset","refs":["source_1.dataset"],"defaultVal":"NewTable_time_1-output-1737","description":""},{"category":"ref","name":"source_schema","refs":["source_1.schemaName"],"defaultVal":"NewTable_time_1-sink-6304","description":""},{"name":"executionId","category":"var","refs":["executionId"],"defaultVal":"0","value":None,"description":"执行记录ID"},{"name":"bizdate","category":"var","refs":["bizdate"],"defaultVal":"19700101","value":None,"description":"业务时间"}],"inputs":[],"outputs":[],"dependencies":[],"tags":None,"description":None,"tagObjs":None,"flowSource":{"sourceType":"QUALITY","sourceId":qa_task[0]["id"],"sourceName":qa_task[0]["name"]},"flowComments":None,"flowId":job_info[0]["id"],"editorId":job_info[0]["owner"],"editorName":"admin","locked":True,"startTime":None,"endTime":None,"enable":True,"customParameter":[{"name":"executionId","category":"var","refs":["executionId"],"defaultVal":"0","value":None,"description":"执行记录ID"},{"name":"bizdate","category":"var","refs":["bizdate"],"defaultVal":"19700101","value":None,"description":"业务时间"}]}
        del new_data['steps']
        del new_data['parameters']
        del new_data['links']
        new_data['steps']=[]
        new_data['parameters']=[]
        new_data['links']=[]
        new_data['steps'].extend(steps_dict)
        new_data['parameters'].extend(parameters_dict)
        new_data['links'].extend(links_dict)
        return job_info[0]["id"], new_data
    except Exception as e:
        log.error("异常信息：%s" % e)


def publish_dsp_flow(data):
    try:
        tenant_id = get_tenant_id()
        data = data.split("#")
        sql = "select id, owner, tenant_id, creator, enabled, steps, parameters,links,name, flow_type, resource_id from merce_flow where tenant_id ='%s' and source='dsflow' and name like'%s%%%%' order by create_time desc limit 1" % (tenant_id,data[0])
        job_info = ms.ExecuQuery(sql.encode('utf-8'))
        sql = "select id,name from dsp_data_service where tenant_id='%s' and name like '%s%%%%' ORDER BY create_time desc limit 1" %(tenant_id,data[1])
        dsp_data_service = ms.ExecuQuery(sql.encode('utf-8'))
        steps_str = parameter_ungzip(job_info[0]["steps"])
        steps_dict = json.loads(steps_str)
        parameters_str = parameter_ungzip(job_info[0]["parameters"])
        parameters_dict = json.loads(parameters_str)
        links_str = parameter_ungzip(job_info[0]["links"])
        links_dict = json.loads(links_str)
        new_data ={"tenantId":job_info[0]["tenant_id"],"owner":job_info[0]["owner"],"name":job_info[0]["name"],"enabled":1,"creator":"admin","createTime":data_now(),"lastModifier":"admin","lastModifiedTime":data_now(),"id":job_info[0]["id"],"version":1,"resourceId":None,"isHide":None,"resource":None,"source":"dsflow","steps":[{"id":"source_1","name":"source_1","type":"source","otherConfigurations":{"schema":"NewTable_time_1_sink_9230","schemaId":"1247612100182507520","sessionCache":"","ignoreMissingPath":False,"interceptor":"","dataset":[{"rule":"set_1","datasetId":"1247612100341891072","ignoreMissingPath":False,"storage":"HDFS","dataset":"NewTable_time_1_output_5849"}]},"inputConfigurations":None,"outputConfigurations":{"output":[{"name":"vachar_Column","type":"string","types":None,"alias":"vachar_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"date_Column","type":"date","types":None,"alias":"date_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","types":None,"alias":"timestamp_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","types":None,"alias":"datetime_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","types":None,"alias":"bigint_column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","types":None,"alias":"decimal_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"double_Column","type":"double","types":None,"alias":"double_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"float_Column","type":"float","types":None,"alias":"float_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"int_Column","type":"int","types":None,"alias":"int_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"banary_Column","type":"string","types":None,"alias":"banary_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"integer_Column","type":"int","types":None,"alias":"integer_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"bool_Column","type":"int","types":None,"alias":"bool_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"bit_Column","type":"int","types":None,"alias":"bit_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"blob_Column","type":"binary","types":None,"alias":"blob_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"char_Column","type":"string","types":None,"alias":"char_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"longblob_Column","type":"string","types":None,"alias":"longblob_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"longtext_Column","type":"string","types":None,"alias":"longtext_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"text_Column","type":"string","types":None,"alias":"text_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","types":None,"alias":"time_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"year_Column","type":"date","types":None,"alias":"year_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"real_Column","type":"double","types":None,"alias":"real_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","types":None,"alias":"double_precision_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"numeric_Column","type":"string","types":None,"alias":"numeric_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0}]},"warningList":None,"errorList":None,"libs":None,"flowId":None,"x":100,"y":200,"implementation":None,"uiConfigurations":{"output":["output"]}},{"id":"filter_1","name":"filter_1","type":"filter","otherConfigurations":{"condition":"1=1","sessionCache":"","interceptor":""},"inputConfigurations":{"input":[{"name":"vachar_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"date_Column","type":"date","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"double_Column","type":"double","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"float_Column","type":"float","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"int_Column","type":"int","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"banary_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"integer_Column","type":"int","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"bool_Column","type":"int","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"bit_Column","type":"int","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"blob_Column","type":"binary","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"char_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"longblob_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"longtext_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"text_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"year_Column","type":"date","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"real_Column","type":"double","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"numeric_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0}]},"outputConfigurations":{"output":[{"name":"vachar_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"date_Column","type":"date","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"double_Column","type":"double","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"float_Column","type":"float","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"int_Column","type":"int","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"banary_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"integer_Column","type":"int","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"bool_Column","type":"int","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"bit_Column","type":"int","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"blob_Column","type":"binary","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"char_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"longblob_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"longtext_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"text_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"year_Column","type":"date","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"real_Column","type":"double","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"numeric_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0}]},"warningList":None,"errorList":None,"libs":None,"flowId":None,"x":300,"y":200,"implementation":None,"uiConfigurations":{"output":["output"],"input":["input"]}},{"id":"filter_2","name":"filter_2","type":"filter","otherConfigurations":{"condition":"${condition}","sessionCache":"","interceptor":""},"inputConfigurations":{"input":[{"name":"vachar_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"date_Column","type":"date","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"double_Column","type":"double","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"float_Column","type":"float","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"int_Column","type":"int","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"banary_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"integer_Column","type":"int","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"bool_Column","type":"int","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"bit_Column","type":"int","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"blob_Column","type":"binary","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"char_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"longblob_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"longtext_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"text_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"year_Column","type":"date","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"real_Column","type":"double","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"numeric_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0}]},"outputConfigurations":{"output":[{"name":"vachar_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"date_Column","type":"date","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"double_Column","type":"double","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"float_Column","type":"float","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"int_Column","type":"int","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"banary_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"integer_Column","type":"int","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"bool_Column","type":"int","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"bit_Column","type":"int","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"blob_Column","type":"binary","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"char_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"longblob_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"longtext_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"text_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"year_Column","type":"date","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"real_Column","type":"double","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"numeric_Column","type":"string","types":None,"alias":"","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0}]},"warningList":None,"errorList":None,"libs":None,"flowId":None,"x":300,"y":200,"implementation":None,"uiConfigurations":{"output":["output"],"input":["input"]}},{"id":"sink_4","name":"sink_4","type":"sink","otherConfigurations":{"hadoop.http.authentication.kerberos.keytab":"/etc/security/keytabs/spnego.service.keytab","ipc.server.tcpnodelay":"true","mapreduce.jobtracker.webinterface.trusted":"false","dfs.replication":"3","fs.gs.path.encoding":"uri-path","hadoop.security.auth_to_local":"RULE:[1:$1@$0](ambari-qa-hdp@HADOOP.COM)s/.*/ambari-qa/\nRULE:[1:$1@$0](hbase-hdp@HADOOP.COM)s/.*/hbase/\nRULE:[1:$1@$0](hdfs-hdp@HADOOP.COM)s/.*/hdfs/\nRULE:[1:$1@$0](yarn-ats-hdp@HADOOP.COM)s/.*/yarn-ats/\nRULE:[1:$1@$0](.*@HADOOP.COM)s/@.*//\nRULE:[2:$1@$0](amshbase@HADOOP.COM)s/.*/ams/\nRULE:[2:$1@$0](amsmon@HADOOP.COM)s/.*/ams/\nRULE:[2:$1@$0](amszk@HADOOP.COM)s/.*/ams/\nRULE:[2:$1@$0](dn@HADOOP.COM)s/.*/hdfs/\nRULE:[2:$1@$0](hbase@HADOOP.COM)s/.*/hbase/\nRULE:[2:$1@$0](hive@HADOOP.COM)s/.*/hive/\nRULE:[2:$1@$0](jhs@HADOOP.COM)s/.*/mapred/\nRULE:[2:$1@$0](knox@HADOOP.COM)s/.*/knox/\nRULE:[2:$1@$0](nm@HADOOP.COM)s/.*/yarn/\nRULE:[2:$1@$0](nn@HADOOP.COM)s/.*/hdfs/\nRULE:[2:$1@$0](rangeradmin@HADOOP.COM)s/.*/ranger/\nRULE:[2:$1@$0](rangertagsync@HADOOP.COM)s/.*/rangertagsync/\nRULE:[2:$1@$0](rangerusersync@HADOOP.COM)s/.*/rangerusersync/\nRULE:[2:$1@$0](rm@HADOOP.COM)s/.*/yarn/\nRULE:[2:$1@$0](yarn@HADOOP.COM)s/.*/yarn/\nRULE:[2:$1@$0](yarn-ats-hbase@HADOOP.COM)s/.*/yarn-ats/\nDEFAULT","DBType":"HDFS","dfs.namenode.audit.log.async":"true","hadoop.http.cross-origin.max-age":"1800","type":"HDFS","autoSchema":"false","dfs.namenode.checkpoint.dir":"/hadoop/hdfs/namesecondary","path":"/auto_test/push","dfs.namenode.avoid.read.stale.datanode":"true","nfs.file.dump.dir":"/tmp/.hdfs-nfs","ipc.client.connection.maxidletime":"30000","keytabPrincipal":"merce@HADOOP.COM","dfs.namenode.https-address":"into1:50470","dfs.secondary.namenode.kerberos.principal":"nn/_HOST@HADOOP.COM","hadoop.http.cross-origin.allowed-headers":"X-Requested-With,Content-Type,Accept,Origin,WWW-Authenticate,Accept-Encoding,Transfer-Encoding","dfs.encrypt.data.transfer.cipher.suites":"AES/CTR/NoPadding","dfs.hosts.exclude":"/etc/hadoop/conf/dfs.exclude","fs.azure.user.agent.prefix":"User-Agent: APN/1.0 Hortonworks/1.0 HDP/3.1.5.0-152","dfs.permissions":"true","dfs.namenode.acls.enabled":"true","dfs.secondary.namenode.keytab.file":"/etc/security/keytabs/nn.service.keytab","hadoop.proxyuser.ambari-server-hdp.hosts":"into1","dfs.namenode.fslock.fair":"false","dfs.web.authentication.kerberos.keytab":"/etc/security/keytabs/spnego.service.keytab","net.topology.script.file.name":"/etc/hadoop/conf/topology_script.py","dfs.permissions.enabled":"true","dfs.permissions.ContentSummary.subAccess":"true","dfs.datanode.balance.bandwidthPerSec":"6250000","hadoop.http.filter.initializers":"org.apache.hadoop.security.AuthenticationFilterInitializer,org.apache.hadoop.security.HttpCrossOriginFilterInitializer","dfs.namenode.stale.datanode.interval":"30000","io.serializations":"org.apache.hadoop.io.serializer.WritableSerialization","schema":"ds_sink_1247628596074086400_20240604111037","hadoop.http.cross-origin.allowed-methods":"GET,PUT,POST,OPTIONS,HEAD,DELETE","hadoop.proxyuser.hive.users":"*","dfs.http.policy":"HTTP_ONLY","hadoop.proxyuser.merce.hosts":"*","dfs.datanode.kerberos.principal":"dn/_HOST@HADOOP.COM","dfs.domain.socket.path":"/var/lib/hadoop-hdfs/dn_socket","hadoop.proxyuser.ambari-server-hdp.groups":"*","dfs.namenode.handler.count":"250","dfs.replication.max":"50","dfs.webhdfs.enabled":"true","hadoop.proxyuser.hdfs.groups":"*","hadoop.proxyuser.knox.hosts":"into95","dfs.namenode.name.dir":"/hadoop/hdfs/namenode","hadoop.proxyuser.merce.users":"*","dfs.namenode.avoid.write.stale.datanode":"true","dfs.namenode.kerberos.principal":"nn/_HOST@HADOOP.COM","fs.trash.interval":"360","dfs.datanode.https.address":"0.0.0.0:50475","dfs.datanode.failed.volumes.tolerated":"0","clusterName":"cluster1","hadoop.proxyuser.knox.groups":"users","dfs.block.access.token.enable":"true","dfs.datanode.data.dir":"/hadoop/hdfs/data","hadoop.proxyuser.hive.hosts":"*","dfs.blocksize":"134217728","fs.s3a.fast.upload.buffer":"disk","nfs.exports.allowed.hosts":"* rw","dfs.datanode.address":"0.0.0.0:1019","hadoop.security.instrumentation.requires.admin":"false","dfs.datanode.data.dir.perm":"750","ha.zookeeper.acl":"sasl:nn:rwcda","ipc.client.connect.max.retries":"50","dfs.namenode.write.stale.datanode.ratio":"1.0f","io.file.buffer.size":"131072","url":"hdfs://into1:8020","fs.s3a.user.agent.prefix":"User-Agent: APN/1.0 Hortonworks/1.0 HDP/3.1.5.0-152","dfs.data.transfer.protection":"authentication,privacy","dfs.namenode.checkpoint.txns":"1000000","dfs.journalnode.edits.dir":"/hadoop/hdfs/journalnode","dfs.namenode.safemode.threshold-pct":"0.99","hadoop.proxyuser.yarn.hosts":"into1","dataset":"ds_sink_1247628596074086400_20240604111037","inSystem":"","dfs.namenode.keytab.file":"/etc/security/keytabs/nn.service.keytab","businessCompany":"","ipc.client.idlethreshold":"8000","mode":"overwrite","inPhoneNumber":"","fs.s3a.fast.upload":"true","manage.include.files":"false","dfs.journalnode.http-address":"0.0.0.0:8480","hadoop.http.authentication.simple.anonymous.allowed":"false","hadoop.security.authorization":"true","dfs.namenode.rpc-address":"into1:8020","fs.gs.application.name.suffix":" (GPN:Hortonworks; version 1.0) HDP/3.1.5.0-152","keytabPath":"/app/merce/kerberos/merce.keytab","dfs.web.authentication.kerberos.principal":"HTTP/_HOST@HADOOP.COM","clusterType":"internal","hadoop.security.authentication":"kerberos","hadoop.proxyuser.hdfs.hosts":"*","dfs.client.read.shortcircuit.streams.cache.size":"4096","isKerberosSupport":True,"format":"txt","inOrganization":"","hadoop.proxyuser.yarn.groups":"*","dfs.namenode.kerberos.internal.spnego.principal":"HTTP/_HOST@HADOOP.COM","separator":",","dfs.datanode.keytab.file":"/etc/security/keytabs/dn.service.keytab","dfs.namenode.accesstime.precision":"0","io.compression.codecs":"org.apache.hadoop.io.compress.GzipCodec,org.apache.hadoop.io.compress.DefaultCodec,org.apache.hadoop.io.compress.SnappyCodec","hadoop.proxyuser.hive.groups":"*","fs.defaultFS":"hdfs://into1:8020","dfs.secondary.namenode.kerberos.internal.spnego.principal":"HTTP/_HOST@HADOOP.COM","fs.s3a.multipart.size":"67108864","dfs.content-summary.limit":"5000","fs.gs.working.dir":"/","hadoop.http.cross-origin.allowed-origins":"*","dfs.journalnode.https-address":"0.0.0.0:8481","clusterId":"cluster1","inReporter":"","dfs.datanode.du.reserved":"187813068800","dfs.datanode.ipc.address":"0.0.0.0:8010","dfs.cluster.administrators":" hdfs","dfs.datanode.max.transfer.threads":"16384","dfs.https.port":"50470","urls":"hdfs://into1:8020","dfs.client.read.shortcircuit":"true","dfs.namenode.http-address":"into1:9870","countWrittenRecord":True,"hadoop.http.authentication.type":"kerberos","datasetId":"2ea0b43c-3e10-4cec-928c-26d0359ff806","dfs.client.retry.policy.enabled":"false","dfs.namenode.inode.attributes.provider.class":"org.apache.ranger.authorization.hadoop.RangerHdfsAuthorizer","hadoop.caller.context.enabled":"true","hadoop.http.authentication.kerberos.principal":"HTTP/_HOST@HADOOP.COM","dfs.namenode.startup.delay.block.deletion.sec":"3600","ignoreRow":"0","dfs.permissions.superusergroup":"hdfs","ha.failover-controller.active-standby-elector.zk.op.retries":"120","dfs.namenode.checkpoint.edits.dir":"${dfs.namenode.checkpoint.dir}","ipc.client.fallback-to-simple-auth-allowed":"true","dfs.blockreport.initialDelay":"120","dfs.namenode.name.dir.restore":"true","dfs.heartbeat.interval":"3","dfs.namenode.secondary.http-address":"into2:50090","hadoop.rpc.protection":"authentication,privacy","fs.permissions.umask-mode":"066","schemaId":"1247628597659533312","krb5ConfigFile":"/app/merce/kerberos/krb5.conf","dfs.namenode.checkpoint.period":"21600","hadoop.http.authentication.signature.secret.file":"/etc/security/http_secret","dfs.datanode.http.address":"0.0.0.0:1022","hadoop.proxyuser.merce.groups":"*","hadoop.proxyuser.HTTP.groups":"users"},"inputConfigurations":{"input":[{"name":"vachar_Column","type":"string","types":None,"alias":"vachar_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"date_Column","type":"date","types":None,"alias":"date_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"timestamp_Column","type":"timestamp","types":None,"alias":"timestamp_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"datetime_Column","type":"timestamp","types":None,"alias":"datetime_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"bigint_column","type":"bigint","types":None,"alias":"bigint_column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"decimal_Column","type":"decimal(20,2)","types":None,"alias":"decimal_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"double_Column","type":"double","types":None,"alias":"double_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"float_Column","type":"float","types":None,"alias":"float_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"int_Column","type":"int","types":None,"alias":"int_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"banary_Column","type":"string","types":None,"alias":"banary_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"integer_Column","type":"int","types":None,"alias":"integer_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"bool_Column","type":"int","types":None,"alias":"bool_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"bit_Column","type":"int","types":None,"alias":"bit_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"blob_Column","type":"binary","types":None,"alias":"blob_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"char_Column","type":"string","types":None,"alias":"char_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"longblob_Column","type":"string","types":None,"alias":"longblob_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"longtext_Column","type":"string","types":None,"alias":"longtext_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"text_Column","type":"string","types":None,"alias":"text_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"time_Column","type":"timestamp","types":None,"alias":"time_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"year_Column","type":"date","types":None,"alias":"year_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"real_Column","type":"double","types":None,"alias":"real_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"double_precision_Column","type":"double","types":None,"alias":"double_precision_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0},{"name":"numeric_Column","type":"string","types":None,"alias":"numeric_Column","description":"","pkFlag":0,"length":0,"algorithmName":None,"fieldCategory":None,"specId":None,"id":0,"formula":"","isCalc":0}]},"outputConfigurations":{},"warningList":None,"errorList":None,"libs":None,"flowId":None,"x":800,"y":100,"implementation":None,"uiConfigurations":{"input":["input"]}}],"links":[{"source":"source_1","sourceOutput":"output","target":"filter_1","targetInput":"input"},{"source":"filter_1","sourceOutput":"output","target":"filter_2","targetInput":"input"},{"source":"filter_2","sourceOutput":"output","target":"sink_4","targetInput":"input"}],"flowType":"dataflow","parameters":[{"name":"filterCondition","category":"ref","refs":["filter_2.condition"],"defaultVal":"1 = 1","value":None,"description":"filter的过滤条件","_uuid_":"dynamic_1"},{"name":"source_dataset","category":"ref","refs":["source_1.dataset"],"defaultVal":"NewTable_time_1_output_5849","value":None,"description":"","_uuid_":"dynamic_2"},{"name":"source_schema","category":"ref","refs":["source_1.schema"],"defaultVal":"NewTable_time_1_sink_9230","value":None,"description":"","_uuid_":"dynamic_3"}],"inputs":[],"outputs":[],"dependencies":[],"tags":None,"description":"dataserviceId:1247628596074086400","tagObjs":None,"flowSource":{"sourceType":"DATASERVICE","sourceId":dsp_data_service[0]["id"],"sourceName":dsp_data_service[0]["name"]},"flowComments":None,"flowId":job_info[0]["id"],"editorId":job_info[0]["owner"],"editorName":"admin","locked":True,"startTime":data_now(),"endTime":None,"enable":True}
        del new_data['steps']
        del new_data['parameters']
        del new_data['links']
        new_data['steps']=[]
        new_data['parameters']=[]
        new_data['links']=[]
        new_data['steps'].extend(steps_dict)
        new_data['parameters'].extend(parameters_dict)
        new_data['links'].extend(links_dict)
        return job_info[0]["id"], new_data
    except Exception as e:
        log.error("异常信息：%s" % e)